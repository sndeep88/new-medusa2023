import{j as c,a as t,r as h,B as b,d as W,F as T,a5 as X,aD as Y,M as S,S as ee}from"./index-effbfb95.js";import{u as te}from"./index-e0338379.js";import{u as $}from"./use-notification-9f7c3c92.js";import{C as le}from"./index-a4458bf1.js";import{r as A,a as re,T as x}from"./index-0d9858ea.js";import{I as ae}from"./image-placeholder-b3cbea02.js";import{S as ne}from"./index-04f3341e.js";import{I as z}from"./index-d33be3e8.js";import{u as ie}from"./use-debounce-438a4ce8.js";import{C as se,u as ce}from"./index.esm-5a89640b.js";import{F as o}from"./form-validator-a60b1f3b.js";import{I as d}from"./index-dd9f9076.js";import"./index-e417090c.js";import{S as oe}from"./index-dd953a8b.js";import{i as ue}from"./countries-bbdb373c.js";import{g as me}from"./error-messages-d2d0bb30.js";import{n as pe}from"./nested-form-c66382a0.js";const Be=({title:e,addr:l})=>{var a;return l?c("div",{className:"flex flex-col pl-6",children:[t("div",{className:"inter-small-regular text-grey-50 mb-1",children:e}),c("div",{className:"flex flex-col inter-small-regular",children:[c("span",{children:[l==null?void 0:l.address_1," ",l==null?void 0:l.address_2]}),c("span",{children:[l==null?void 0:l.postal_code," ",l==null?void 0:l.city,", ",l!=null&&l.province?`${l.province} `:"",(a=l==null?void 0:l.country_code)==null?void 0:a.toUpperCase()]})]})]}):c("div",{className:"flex flex-col pl-6",children:[t("div",{className:"inter-small-regular text-grey-50 mb-1",children:e}),t("div",{className:"flex flex-col inter-small-regular",children:"N/A"})]})},Me=({value:e,displayValue:l,successDuration:a=3e3,showValue:i=!0,iconSize:p=20,onCopy:y=()=>{}})=>{const[n,f]=te(e,{onCopied:y,successDuration:a}),s=$();return h.useEffect(()=>{n&&s("Success","Copied!","success")},[n,s]),c("div",{className:"inter-small-regular flex items-center gap-x-xsmall text-grey-50",children:[t(b,{variant:"ghost",size:"small",type:"button",className:W("p-0 text-grey-50",{"text-violet-60":n}),onClick:f,children:t(le,{size:p})}),i&&t("span",{className:"w-full truncate",children:l||e})]})};var k=(e=>(e.SHIPPING="shipping",e.BILLING="billing",e.LOCATION="location",e))(k||{});const he=({form:e,countryOptions:l,type:a,required:i=!0,noTitle:p=!1})=>{const{register:y,path:n,control:f,formState:{errors:s}}=e;return c("div",{children:[(a==="shipping"||a==="billing")&&c(T,{children:[t("span",{className:"inter-base-semibold",children:"General"}),c("div",{className:"grid grid-cols-2 mt-4 mb-8 gap-large",children:[t(d,{...y(n("first_name"),{required:i?o.required("First name"):!1,pattern:o.whiteSpaceRule("First name")}),placeholder:"First Name",label:"First Name",required:i,errors:s}),t(d,{...e.register(n("last_name"),{required:i?o.required("Last name"):!1,pattern:o.whiteSpaceRule("Last name")}),placeholder:"Last Name",label:"Last Name",required:i,errors:s}),t(d,{...e.register(n("company"),{pattern:o.whiteSpaceRule("Company")}),placeholder:"Company",label:"Company",errors:s}),t(d,{...e.register(n("phone")),placeholder:"Phone",label:"Phone",errors:s})]})]}),!p&&t("span",{className:"inter-base-semibold",children:`${a==="billing"?"Billing Address":a==="shipping"?"Shipping Address":"Address"}`}),c("div",{className:"grid grid-cols-2 mt-4 gap-y-large gap-x-large",children:[t(d,{...e.register(n("address_1"),{required:i?o.required("Address 1"):!1,pattern:o.whiteSpaceRule("Address 1")}),placeholder:"Address 1",label:"Address 1",required:i,errors:s}),t(d,{...e.register(n("address_2"),{pattern:o.whiteSpaceRule("Address 2")}),placeholder:"Address 2",label:"Address 2",errors:s}),t(d,{...e.register(n("postal_code"),{required:i?o.required("Postal code"):!1,pattern:o.whiteSpaceRule("Postal code")}),placeholder:"Postal code",label:"Postal code",required:i,autoComplete:"off",errors:s}),t(d,{placeholder:"City",label:"City",...e.register(n("city"),{required:i?o.required("City"):!1,pattern:o.whiteSpaceRule("City")}),required:i,errors:s}),t(d,{...e.register(n("province"),{pattern:o.whiteSpaceRule("Province")}),placeholder:"Province",label:"Province",errors:s}),t(se,{control:f,name:n("country_code"),rules:{required:i?o.required("Country"):!1},render:({field:{value:N,onChange:_}})=>t(oe,{label:"Country",required:i,value:N,options:l,onChange:_,name:n("country_code"),errors:s,isClearable:!i})})]})]})},fe=e=>{switch(e){case"proposed":return"warning";case"published":return"success";case"rejected":return"danger";case"draft":default:return"default"}},ze=({onSubmit:e,selectedItems:l})=>{const{pop:i}=h.useContext(X),[p,y]=h.useState(""),[n,f]=h.useState(0),[s,N]=h.useState(0),[_,m]=h.useState(0),[C,w]=h.useState([]),G=ie(p,500),{isLoading:R,count:v,variants:P}=Y({q:G,limit:12,offset:n});h.useEffect(()=>{typeof v<"u"&&N(Math.ceil(v/12))},[v]);const E=h.useMemo(()=>[{Header:"Name",accessor:"title",Cell:({row:{original:r}})=>c("div",{className:"flex items-center",children:[t("div",{className:"h-[40px] w-[30px] my-1.5 flex items-center mr-4",children:r.product.thumbnail?t("img",{src:r.product.thumbnail,className:"h-full object-cover rounded-soft"}):t(ae,{})}),c("div",{className:"flex flex-col",children:[t("span",{children:r.product.title}),r.title]})]})},{Header:"Status",accessor:"status",Cell:({row:{original:r}})=>t(ne,{title:`${r.product.status.charAt(0).toUpperCase()}${r.product.status.slice(1)}`,variant:fe(r.product.status)})},{Header:t("div",{className:"text-right",children:"In Stock"}),accessor:"inventory_quantity",Cell:({row:{original:r}})=>t("div",{className:"text-right",children:r.inventory_quantity})}],[]),{getTableProps:O,getTableBodyProps:H,rows:F,prepareRow:D,canPreviousPage:L,canNextPage:B,pageCount:Z,nextPage:q,previousPage:U,state:{pageIndex:V,pageSize:M,selectedRowIds:I}}=A.useTable({columns:E,data:P||[],manualPagination:!0,initialState:{pageIndex:_,pageSize:12,selectedRowIds:l.reduce((r,{id:g})=>(r[g]=!0,r),{})},pageCount:s,autoResetSelectedRows:!1,autoResetPage:!1,getRowId:r=>r.id},A.usePagination,A.useRowSelect,r=>{r.visibleColumns.push(g=>[{id:"selection",Header:({getToggleAllRowsSelectedProps:u})=>t("div",{children:t(z,{...u()})}),Cell:({row:u})=>t("div",{children:t(z,{...u.getToggleRowSelectedProps()})})},...g])});h.useEffect(()=>{w(r=>[...r.filter(g=>Object.keys(I).findIndex(u=>u===g.id)>-1),...(P==null?void 0:P.filter(g=>r.findIndex(u=>u.id===g.id)<0&&Object.keys(I).findIndex(u=>u===g.id)>-1))||[]])},[I]);const j=()=>{B&&(f(r=>r+M),m(r=>r+1),q())},Q=()=>{L&&(f(r=>Math.max(r-M,0)),m(r=>r-1),U())},J=r=>{f(0),m(0),y(r)},K=()=>{e(C),i()};return c(T,{children:[t(S.Content,{children:t(re,{isLoading:R,numberOfRows:12,hasPagination:!0,pagingState:{count:v,offset:n,pageSize:n+F.length,title:"Products",currentPage:V+1,pageCount:Z,nextPage:j,prevPage:Q,hasNext:B,hasPrev:L},children:t(x,{immediateSearchFocus:!0,enableSearch:!0,searchPlaceholder:"Search Products..",searchValue:p,handleSearch:J,...O(),children:t(x.Body,{...H(),children:R?t(x.Row,{children:t(x.Cell,{colSpan:E.length,className:"flex items-center justify-center",children:t(ee,{size:"large",variant:"secondary"})})}):F.map((r,g)=>(D(r),t(x.Row,{...r.getRowProps(),children:r.cells.map(u=>t(x.Cell,{...u.getCellProps(),children:u.render("Cell")}))})))})})})}),t(S.Footer,{children:c("div",{className:"flex w-full justify-end gap-x-xsmall",children:[t(b,{variant:"ghost",size:"small",className:"w-[112px]",onClick:()=>i(),children:"Back"}),t(b,{variant:"primary",className:"w-[112px]",size:"small",onClick:K,children:"Add"})]})})]})},Te=e=>{if(!e)return"N/A";if(e.customer){const l=e.customer.first_name,a=e.customer.last_name;if(l&&a)return`${l} ${a}`;if(l)return l;if(a)return a}if(e.shipping_address){const l=e.shipping_address.first_name,a=e.shipping_address.last_name;if(l&&a)return`${l} ${a}`;if(l)return l;if(a)return a}if(e.billing_address){const l=e.billing_address.first_name,a=e.billing_address.last_name;if(l&&a)return`${l} ${a}`;if(l)return l;if(a)return a}return e.email?e.email:"N/A"},$e=({address:e,allowedCountries:l=[],handleClose:a,submit:i,type:p,submitting:y=!1})=>{const n=ce({defaultValues:ge(e)}),{formState:{isDirty:f}}=n,s=$(),N=l.map(m=>({label:m.display_name,value:m.iso_2})).filter(Boolean),_=m=>{const C={};return p==="shipping"?C.shipping_address={...m,country_code:m.country_code.value}:C.billing_address={...m,country_code:m.country_code.value},i(C,{onSuccess:()=>{s("Success","Successfully updated address","success"),a()},onError:w=>s("Error",me(w),"error")})};return t(S,{handleClose:a,isLargeModal:!0,children:t("form",{onSubmit:n.handleSubmit(_),children:c(S.Body,{children:[t(S.Header,{handleClose:a,children:c("span",{className:"inter-xlarge-semibold",children:[p===k.BILLING?"Billing":"Shipping"," Address"]})}),t(S.Content,{children:t(he,{form:pe(n),countryOptions:N,type:p})}),t(S.Footer,{children:c("div",{className:"flex justify-end w-full h-8",children:[t(b,{variant:"ghost",className:"justify-center w-32 mr-2 text-small",size:"large",onClick:a,type:"button",children:"Cancel"}),t(b,{size:"large",className:"justify-center w-32 text-small",variant:"primary",type:"submit",loading:y,disabled:y||!f,children:"Save"})]})})]})})})},ge=e=>{var a;const l=ue[(a=e==null?void 0:e.country_code)==null?void 0:a.toUpperCase()];return{first_name:(e==null?void 0:e.first_name)||"",last_name:(e==null?void 0:e.last_name)||"",phone:(e==null?void 0:e.phone)||null,company:(e==null?void 0:e.company)||null,address_1:(e==null?void 0:e.address_1)||"",address_2:(e==null?void 0:e.address_2)||null,city:(e==null?void 0:e.city)||"",province:(e==null?void 0:e.province)||null,country_code:e!=null&&e.country_code?{label:l,value:e.country_code}:{label:"",value:""},postal_code:(e==null?void 0:e.postal_code)||""}};export{he as A,Me as C,Be as F,ze as R,k as a,$e as b,Te as e};
