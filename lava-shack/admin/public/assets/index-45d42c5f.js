import{J as w,bH as C,r as m,a as e,M as d,j as s,B as f}from"./index-effbfb95.js";import{u as j}from"./index.esm-5a89640b.js";import{u as k}from"./use-notification-9f7c3c92.js";import{g as p}from"./error-messages-d2d0bb30.js";import{I as g,a as q}from"./index-dd9f9076.js";import{M as E}from"./index-52359d87.js";const z=({onClose:n,isEdit:l=!1,collection:a})=>{const{mutate:b,isLoading:x}=w(a==null?void 0:a.id),{mutate:y,isLoading:S}=C(),{register:o,handleSubmit:v,reset:M}=j(),c=k(),[u,h]=m.useState([]);if(l&&!a)throw new Error("Collection is required for edit");m.useEffect(()=>{o("title",{required:!0}),o("handle")},[]),m.useEffect(()=>{l&&a&&(M({title:a.title,handle:a.handle}),a.metadata&&Object.entries(a.metadata).map(([i,r])=>{if(typeof r=="string"){const t=u;t.push({key:i,value:r}),h(t)}}))},[a,l]);const N=i=>{l?b({title:i.title,handle:i.handle,metadata:u.reduce((r,t)=>({...r,[t.key]:t.value}),{})},{onSuccess:()=>{c("Success","Successfully updated collection","success"),n()},onError:r=>{c("Error",p(r),"error")}}):y({title:i.title,handle:i.handle,metadata:u.reduce((r,t)=>({...r,[t.key]:t.value}),{})},{onSuccess:()=>{c("Success","Successfully created collection","success"),n()},onError:r=>{c("Error",p(r),"error")}})};return e(d,{handleClose:n,isLargeModal:!0,children:s(d.Body,{children:[e(d.Header,{handleClose:n,children:s("div",{children:[e("h1",{className:"inter-xlarge-semibold mb-2xsmall",children:l?"Edit Collection":"Add Collection"}),e("p",{className:"inter-small-regular text-grey-50",children:"To create a collection, all you need is a title and a handle."})]})}),s("form",{onSubmit:v(N),children:[s(d.Content,{children:[s("div",{children:[e("h2",{className:"inter-base-semibold mb-base",children:"Details"}),s("div",{className:"flex items-center gap-x-base",children:[e(g,{label:"Title",required:!0,placeholder:"Sunglasses",...o("title",{required:!0})}),e(g,{label:"Handle",placeholder:"sunglasses",...o("handle"),prefix:"/",tooltip:e(q,{content:"URL Slug for the collection. Will be auto generated if left blank."})})]})]}),e("div",{className:"mt-xlarge w-full",children:e(E,{setMetadata:h,metadata:u})})]}),e(d.Footer,{children:s("div",{className:"flex items-center justify-end w-full gap-x-xsmall",children:[e(f,{variant:"secondary",size:"small",type:"button",onClick:n,children:"Cancel"}),e(f,{variant:"primary",size:"small",loading:l?x:S,children:`${l?"Save":"Publish"} collection`})]})})]})]})})};export{z as C};
