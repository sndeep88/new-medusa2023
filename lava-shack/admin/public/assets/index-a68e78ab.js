import{r as p,j as l,d as ee,a as e,q as re,u as fe,a2 as yt,a3 as de,a4 as nt,$ as qt,e as Qe,a5 as $,B as _,a6 as ge,F as D,M as b,K as ye,m as Ce,a7 as be,a8 as ve,a9 as Ct,aa as $t,ab as Bt,ac as bt,ad as vt,ae as Vt,af as St,G as Yt,S as xt,C as Qt,R as Jt,b as Ze}from"./index-effbfb95.js";import{F as Xt}from"./index-ec3b8ff9.js";import{P as Se,a as at,I as V}from"./index-dd9f9076.js";import{B as Je}from"./body-card-d3fddb8c.js";import{T as Wt}from"./index-a6859a1b.js";import{l as $e}from"./lodash-72dfe3e0.js";import{r as dt,a as Zt,T,A as _t,S as te}from"./index-0d9858ea.js";import{u as Kt}from"./analytics-1ab31609.js";import{F as es,a as ts,S as ss,b as rs,D as Be}from"./index-b17c211e.js";import{B as Xe,f as Nt}from"./index-84767cd7.js";import{S as ce}from"./index-04f3341e.js";import{r as ns}from"./time-5c3c185e.js";import{u as wt}from"./use-imperative-dialog-cb4e5fcf.js";import{u as Y}from"./use-notification-9f7c3c92.js";import{g as q}from"./error-messages-d2d0bb30.js";import{D as as}from"./duplicate-icon-dbea12ca.js";import{P as os,U as is}from"./index-4a064b3c.js";import{T as ne}from"./trash-icon-abcb5140.js";import{E as xe}from"./edit-icon-8c1c10d1.js";import{r as Dt}from"./remove-nullish-de5411fd.js";import{C as cs,B as ls}from"./index-d895e52c.js";import{D as ds}from"./delete-prompt-37f35e36.js";import{R as us}from"./index-698bc9f9.js";import{u as ot,F as ms,a as ps,C as G,b as We}from"./index.esm-5a89640b.js";import{S as O,T as Ve,C as hs}from"./time-picker-3cbb3a44.js";import{u as R}from"./use-query-filters-844ebb5f.js";import{R as K}from"./index-b6a697c3.js";import{I as fs}from"./image-placeholder-b3cbea02.js";import{S as he}from"./index-523daaeb.js";import{h as ut}from"./moment-fbc5633a.js";import{S as gs}from"./index-f2ff65ef.js";import"./index-e417090c.js";import{S as Tt}from"./index-dd953a8b.js";import{T as Pt}from"./index-d74195ae.js";import{C as Ye}from"./index-dbc7810f.js";import{F as Ke}from"./focus-modal-d105ce27.js";import{A as Z}from"./index-bf34ad3b.js";import{C as ys}from"./index-b6704001.js";import"./chevron-down-6a69fe38.js";import"./use-debounce-438a4ce8.js";import"./axios-4a70c6fc.js";import"./a-0eba6a7f.js";import"./react-hotkeys-hook.esm-745ca041.js";import"./nested-form-c66382a0.js";import"./index-e25e2e97.js";import"./unsupportedIterableToArray-27301055.js";import"./createSuper-ad9f6885.js";import"./index-202b6dd7.js";import"./arrow-down-icon-49435f5a.js";import"./index-903c1727.js";import"./chevron-up-ae6c75fe.js";import"./react-select.esm-1ec1493a.js";import"./toConsumableArray-6f61c395.js";import"./index-1ec19c89.js";import"./index-e0338379.js";import"./index-0f96226b.js";import"./index-a4458bf1.js";import"./index-d33be3e8.js";import"./_isIndex-6af6139d.js";import"./index-740955bd.js";import"./react-select-creatable.esm-e43d0869.js";import"./index.esm-841d990e.js";const Cs=["normal","dynamic"],bs=({tabs:t,activeTab:s,onTabClick:n,onSaveTab:r,onRemoveTab:a,filters:i,submitFilters:h,clearFilters:d})=>{const[f,o]=p.useState(i),[m,g]=p.useState(""),u=P=>{a&&a(P)},c=()=>{r&&r(m,f)},y=P=>{n&&n(P)};p.useEffect(()=>{o(i)},[i]);const C=()=>{h(f)},I=()=>{d()},L=(P,J)=>{o(A=>({...A,[P]:J}))},z=Object.entries(i).reduce((P,[J,A])=>(A!=null&&A.open&&(P=P+1),P),0);return l("div",{className:"flex space-x-1",children:[l(es,{submitFilters:C,clearFilters:I,triggerElement:l("button",{className:ee("flex rounded-rounded items-center space-x-1 focus-visible:outline-none focus-visible:shadow-input focus-visible:border-violet-60"),children:[l("div",{className:"flex rounded-rounded items-center bg-grey-5 border border-grey-20 inter-small-semibold px-2 h-6",children:["Filters",e("div",{className:"text-grey-40 ml-1 flex items-center rounded",children:e("span",{className:"text-violet-60 inter-small-semibold",children:z||"0"})})]}),e("div",{className:"flex items-center rounded-rounded bg-grey-5 border border-grey-20 inter-small-semibold p-1",children:e(Se,{size:14})})]}),children:[e(ts,{filterTitle:"Types",options:Cs,filters:f.isDynamic.filter,open:f.isDynamic.open,setFilter:P=>L("isDynamic",P)}),e(ss,{saveFilter:c,name:m,setName:g})]}),t&&t.map(P=>e(rs,{onClick:()=>y(P.value),label:P.label,isActive:s===P.value,removable:!!P.removable,onRemove:()=>u(P.value)},P.value))]})},ae="\\d+(?:[\\.,]\\d+)?",vs=`(${ae}W)`,Ss=`(${ae}Y)?(${ae}M)?(${ae}D)?`,xs=`T(${ae}H)?(${ae}M)?(${ae}S)?`,_s=`P(?:${vs}|${Ss}(?:${xs})?)`,Ns=["weeks","years","months","days","hours","minutes","seconds"],ws=Object.freeze({years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0}),Ds=new RegExp(_s),it=t=>t.match(Ds).slice(1).reduce((s,n,r)=>(s[Ns[r]]=parseFloat(n)||0,s),{}),Ts=(t,s)=>{t=Object.assign({},ws,t);const n=s?s.getTime():Date.now(),r=new Date(n);return r.setFullYear(r.getFullYear()+t.years),r.setMonth(r.getMonth()+t.months),r.setDate(r.getDate()+t.days),r.setHours(r.getHours()+t.hours),r.setMinutes(r.getMinutes()+t.minutes),r.setMilliseconds(r.getMilliseconds()+t.seconds*1e3),r.setDate(r.getDate()+t.weeks*7),r},Ps=t=>{if(!t.is_disabled){const s=new Date;return new Date(t.starts_at)>s?"SCHEDULED":t.ends_at&&new Date(t.ends_at)<s||t.valid_duration&&s>Ts(it(t.valid_duration),new Date(t.starts_at))||t.usage_count===t.usage_limit?"EXPIRED":"ACTIVE"}return"DISABLED"},Os=t=>{switch(Ps(t)){case"SCHEDULED":return e(ce,{title:"Scheduled",variant:"warning"});case"EXPIRED":return e(ce,{title:"Expired",variant:"danger"});case"ACTIVE":return e(ce,{title:"Active",variant:"success"});case"DISABLED":return e(ce,{title:"Disabled",variant:"default"});default:return e(ce,{title:"Disabled",variant:"default"})}},Rs=t=>{var s;return t.rule.type==="fixed"&&(s=t.regions)!=null&&s.length?t.regions[0].currency_code.toUpperCase():""},Es=t=>{var s;switch(t.rule.type){case"fixed":return(s=t.regions)!=null&&s.length?Nt({currency:t.regions[0].currency_code,amount:t.rule.value}):"";case"percentage":return`${t.rule.value}%`;case"free_shipping":return"Free Shipping";default:return""}},Is=()=>[p.useMemo(()=>[{Header:e("div",{className:"pl-2",children:"Code"}),accessor:"code",Cell:({cell:{value:s}})=>e("div",{className:"overflow-hidden",children:e(Xe,{className:"rounded-rounded",variant:"default",children:e("span",{className:"inter-small-regular",children:s})})})},{Header:"Description",accessor:"rule.description",Cell:({cell:{value:s}})=>s},{Header:e("div",{className:"text-right",children:"Amount"}),id:"amount",Cell:({row:{original:s}})=>e("div",{className:"text-right",children:Es(s)})},{Header:e("div",{className:"w-[60px]"}),id:"currency",Cell:({row:{original:s}})=>e("div",{className:"px-2 text-grey-40",children:Rs(s)})},{Header:"Status",accessor:"ends_at",Cell:({row:{original:s}})=>e("div",{children:Os(s)})},{Header:()=>e("div",{className:"text-right",children:"Redemptions"}),accessor:"usage_count",Cell:({row:{original:s}})=>e("div",{className:"text-right",children:As(s.usage_count)})}],[])],As=t=>{switch(!0){case t>9999999:return`${Math.floor(t/1e6)}m`;case t>9999:return`${Math.floor(t/1e3)}k`;default:return t}},ks=["status","is_dynamic","q","created_at","offset","limit"],et={},Fs=t=>t===null?t:Object.entries(t).reduce((n,[r,a])=>(a.includes("|")?n[r]=ns(a):n[r]=a,n),{}),Ms=(t,s)=>{var n;switch(s.type){case"setFilters":return{...t,query:(n=s==null?void 0:s.payload)==null?void 0:n.query,isDynamic:s.payload.isDynamic,date:s.payload.date};case"setQuery":return{...t,offset:0,query:s.payload};case"setOffset":return{...t,offset:s.payload};case"reset":return s.payload;default:return t}},Hs=(t,s)=>{if(t.size!==s.size)return!1;for(const n of t)if(!s.has(n))return!1;return!0},Ls=(t,s=null)=>{t&&t[0]==="?"&&(t=t.substring(1));const n=p.useMemo(()=>Us(t,s),[t,s]),r=p.useMemo(()=>{const v=localStorage.getItem("promotions::filters");if(v){const N=JSON.parse(v);if(N)return Object.entries(N).map(([x,w])=>({label:x,value:x,removable:!0,representationString:w}))}return[]},[]),[a,i]=p.useReducer(Ms,n),[h,d]=p.useState(r),f=v=>{i({type:"setDefaults",payload:v})},o=v=>{if(v>0){const N=a.offset+a.limit;i({type:"setOffset",payload:N})}else{const N=Math.max(a.offset-a.limit,0);i({type:"setOffset",payload:N})}},m=()=>{i({type:"setFilters",payload:{...a,offset:0,date:{open:!1,filter:null},isDynamic:{open:!1,filter:["normal"]},query:null}})},g=v=>{i({type:"setFilters",payload:v})},u=v=>{i({type:"setQuery",payload:v})},c=()=>{const v={...a.additionalFilters};for(const[N,x]of Object.entries(a))if(N==="query")x&&typeof x=="string"&&(v.q=x);else if(N==="offset"||N==="limit")v[N]=x;else if(x.open)if(N==="date")v[W[N]]=Fs(x.filter);else if(N==="isDynamic"){const w=x.filter;w&&w.includes("normal")&&w.includes("dynamic")||(w.includes("normal")?v[W[N]]=!1:w.includes("dynamic")?v[W[N]]=!0:v[W[N]]=!1)}else v[W[N]]=x.filter;return v},y=()=>{const v=c();return re.stringify(v,{skipNulls:!0})},C=v=>{const N=v??a,x={};for(const[w,k]of Object.entries(N))if(w==="query")k&&typeof k=="string"&&(x.q=k);else if(w==="isDynamic"){const M=k.filter;M&&M.includes("normal")&&M.includes("dynamic")?x[W[w]]="all":M.includes("normal")?x[W[w]]=!1:M.includes("dynamic")?x[W[w]]=!0:x[W[w]]=!1}else w==="offset"||w==="limit"?x[w]=k:k.open&&(x[W[w]]=k.filter);return x},I=()=>{const v=C();return re.stringify(v,{skipNulls:!0})},L=p.useMemo(()=>c(),[a]),z=p.useMemo(()=>C(),[a]),P=p.useMemo(()=>I(),[a]),J=p.useMemo(()=>{const v=$e.omit(z,["limit","offset"]),N=re.stringify(v),x=h.find(w=>w.representationString===N);if(x)return x.value;for(const[w,k]of Object.entries(et)){let M=!0;if(Object.keys(v).length===Object.keys(k).length){for(const[B,X]of Object.entries(k))if(B in v?Array.isArray(X)?M=Array.isArray(v[B])&&Hs(new Set(v[B]),new Set(X)):M=v[B]===X:M=!1,!M)break;if(M)return w}}return null},[z,h]),A=p.useMemo(()=>[...h],[h]),ue=v=>{let N=null;if(v in et)N=et[v];else{const x=h.find(w=>w.value===v);x&&(N=re.parse(x.representationString))}if(N){const x={...a,date:{open:!1,filter:null},isDynamic:{open:!1,filter:["normal"]}};for(const[w,k]of Object.entries(N))x[js[w]]={open:!0,filter:k};i({type:"setFilters",payload:x})}},me=(v,N)=>{const x=C({...N}),w=$e.omit(x,["limit","offset"]),k=re.stringify(w,{skipNulls:!0}),M=localStorage.getItem("promotions::filters");let B=null;if(M&&(B=JSON.parse(M)),B)B[v]=k,localStorage.setItem("promotions::filters",JSON.stringify(B));else{const X={};X[v]=k,localStorage.setItem("promotions::filters",JSON.stringify(X))}d(X=>[...X,{label:v,value:v,representationString:k,removable:!0}]),i({type:"setFilters",payload:N})},ie=v=>{const N=localStorage.getItem("promotions::filters");let x=null;N&&(x=JSON.parse(N)),x&&(delete x[v],localStorage.setItem("promotions::filters",JSON.stringify(x))),d(w=>w.filter(M=>M.value!==v))};return{...a,filters:{...a},removeTab:ie,saveTab:me,setTab:ue,availableTabs:A,activeFilterTab:J,representationObject:z,representationString:P,queryObject:L,paginate:o,getQueryObject:c,getQueryString:y,setQuery:u,setFilters:g,setDefaultFilters:f,reset:m}},js={is_dynamic:"isDynamic",created_at:"date"},W={isDynamic:"is_dynamic",date:"created_at"},Us=(t,s=null)=>{const n={date:{open:!1,filter:null},isDynamic:{open:!1,filter:["normal"]},offset:0,limit:15,additionalFilters:s};if(t){const r=re.parse(t);for(const[a,i]of Object.entries(r))if(ks.includes(a))switch(a){case"is_dynamic":{typeof i=="string"&&(i==="true"?n.isDynamic={open:!0,filter:["dynamic"]}:i==="false"?n.isDynamic={open:!0,filter:["normal"]}:i==="all"&&(n.isDynamic={open:!0,filter:["normal","dynamic"]}));break}case"offset":{typeof i=="string"&&(n.offset=parseInt(i));break}case"created_at":{n.date={open:!0,filter:i};break}case"limit":{typeof i=="string"&&(n.limit=parseInt(i));break}case"q":{typeof i=="string"&&(n.query=i);break}}}return n},zs=()=>{const t=fe(),s=Y(),n=yt();return async a=>{const i={code:`${a.code}_COPY`,is_disabled:a.is_disabled,is_dynamic:a.is_dynamic,starts_at:a.starts_at,regions:a.regions.map(h=>h.id)};a.ends_at&&(i.ends_at=a.ends_at),a.valid_duration&&(i.valid_duration=a.valid_duration),typeof a.usage_limit=="number"&&(i.usage_limit=a.usage_limit),a.metadata&&(i.metadata=a.metadata),i.rule={type:a.rule.type,value:a.rule.value,description:a.rule.description},a.rule.allocation&&(i.rule.allocation=a.rule.allocation),a.rule.conditions&&(i.rule.conditions=a.rule.conditions.map(h=>({operator:h.operator,...Dt({products:h.products,product_types:h.product_types,product_tags:h.product_tags,product_collections:h.product_collections,customer_groups:h.customer_groups})}))),await n.mutate(i,{onSuccess:h=>{t(`/a/discounts/${h.discount.id}`),s("Success","Successfully copied discount","success")},onError:h=>{s("Error",q(h),"error")}})}},Gs=t=>{const s=fe(),n=Y(),r=wt(),a=zs(),i=de(t.id),h=nt(t==null?void 0:t.id),d=async()=>{await r({heading:"Delete Discount",text:"Are you sure you want to delete this Discount?"})&&h.mutate()};return{getRowActions:()=>[{label:"Edit",icon:e(xe,{size:20}),onClick:()=>s(`/a/discounts/${t.id}`)},{label:t.is_disabled?"Publish":"Unpublish",icon:t.is_disabled?e(os,{size:20}):e(is,{size:20}),onClick:()=>{i.mutate({is_disabled:!t.is_disabled},{onSuccess:()=>{n("Success",`Successfully ${t.is_disabled?"published":"unpublished"} discount`,"success")},onError:o=>n("Error",q(o),"error")})}},{label:"Duplicate",icon:e(as,{size:20}),onClick:()=>a(t)},{label:"Delete",icon:e(ne,{size:20}),variant:"danger",onClick:d}]}},mt=15,qs={},$s=()=>{const{removeTab:t,setTab:s,saveTab:n,availableTabs:r,activeFilterTab:a,reset:i,paginate:h,setFilters:d,filters:f,setQuery:o,queryObject:m,representationObject:g}=Ls(location.search,qs),{trackNumberOfDiscounts:u}=Kt(),c=parseInt(m==null?void 0:m.offset)||0,y=parseInt(m.limit)||mt,{discounts:C,isLoading:I,count:L}=qt({is_dynamic:!1,expand:"rule,rule.conditions,rule.conditions.products,regions",...m},{keepPreviousData:!0,onSuccess:({count:H})=>{u({count:H})}}),[z,P]=p.useState(""),[J,A]=p.useState(0);p.useEffect(()=>{if(L&&m.limit){const H=Math.ceil(L/m.limit);H!==J&&A(H)}},[L,m.limit]);const[ue]=Is(),{getTableProps:me,getTableBodyProps:ie,headerGroups:v,rows:N,prepareRow:x,canPreviousPage:w,canNextPage:k,pageCount:M,gotoPage:B,nextPage:X,previousPage:Ht,state:{pageIndex:Lt}}=dt.useTable({columns:ue,data:C||[],manualPagination:!0,initialState:{pageSize:y,pageIndex:c/y},pageCount:J,autoResetPage:!1},dt.usePagination);p.useEffect(()=>{const H=setTimeout(()=>{z?(o(z),B(0)):i()},400);return()=>clearTimeout(H)},[z]);const jt=()=>{k&&(h(1),X())},Ut=()=>{w&&(h(-1),Ht())},lt=(H={})=>{const Ge=re.stringify(H);window.history.replaceState("/a/discounts","",`${`?${Ge}`}`)},zt=()=>{const H=g;$e.isEmpty(H)?lt({offset:0,limit:mt}):lt(H)},Gt=()=>{i(),P("")};return p.useEffect(()=>{zt()},[g]),e(Zt,{hasPagination:!0,isLoading:I,numberOfRows:m.limit,pagingState:{count:L,offset:m.offset,pageSize:m.offset+N.length,title:"Discounts",currentPage:Lt+1,pageCount:M,nextPage:jt,prevPage:Ut,hasNext:k,hasPrev:w},children:l(T,{filteringOptions:e(bs,{filters:f,submitFilters:d,clearFilters:Gt,tabs:r,onTabClick:s,activeTab:a,onRemoveTab:t,onSaveTab:n}),enableSearch:!0,handleSearch:P,searchPlaceholder:"Search by code or description...",searchValue:z,...me(),children:[e(T.Head,{children:v==null?void 0:v.map(H=>e(T.HeadRow,{...H.getHeaderGroupProps(),children:H.headers.map(Ge=>e(T.HeadCell,{...Ge.getHeaderProps(),children:Ge.render("Header")}))}))}),e(T.Body,{...ie(),children:N.map(H=>(x(H),e(Bs,{row:H},H.original.id)))})]})})},Bs=({row:t})=>{const s=t.original,{getRowActions:n}=Gs(s);return e(T.Row,{color:"inherit",linkTo:t.original.id,...t.getRowProps(),actions:n(),className:"group",children:t.cells.map(r=>e(T.Cell,{...r.getCellProps(),children:r.render("Cell")}))})};var S=(t=>(t.PRODUCTS="products",t.PRODUCT_TYPES="product_types",t.PRODUCT_COLLECTIONS="product_collections",t.PRODUCT_TAGS="product_tags",t.CUSTOMER_GROUPS="customer_groups",t))(S||{}),j=(t=>(t.IN="in",t.NOT_IN="not_in",t))(j||{}),le=(t=>(t.ITEM="item",t.TOTAL="total",t))(le||{}),se=(t=>(t.FIXED="fixed",t.PERCENTAGE="percentage",t.FREE_SHIPPING="free_shipping",t))(se||{});const pt={products:{id:void 0,operator:j.IN,type:S.PRODUCTS,items:[]},product_collections:{id:void 0,operator:j.IN,type:S.PRODUCT_COLLECTIONS,items:[]},product_tags:{id:void 0,operator:j.IN,type:S.PRODUCT_TAGS,items:[]},product_types:{id:void 0,operator:j.IN,type:S.PRODUCT_TYPES,items:[]},customer_groups:{id:void 0,operator:j.IN,type:S.CUSTOMER_GROUPS,items:[]}},ct=({children:t})=>{const[s,n]=p.useState(!1),[r,a]=p.useState(!1),[i,h]=p.useState(null),[d,f]=p.useState(null),[o,m]=p.useState(pt),g=({type:A,items:ue,operator:me})=>{m(ie=>({...ie,[A]:{...ie[A],items:ue,operator:me}}))},u=ot({defaultValues:{rule:{type:se.PERCENTAGE,allocation:le.TOTAL}},shouldUnregister:!0}),c=u.watch("rule.type"),y=u.watch("is_dynamic"),C=u.watch("usage_limit"),I=u.watch("valid_duration"),L=u.watch("ends_at"),z=u.watch("starts_at");p.useEffect(()=>{s&&!L&&u.setValue("ends_at",new Date(new Date().getTime()+7*24*60*60*1e3)),!s&&L&&u.setValue("ends_at",null)},[L,s]),p.useEffect(()=>{r&&!z&&u.setValue("starts_at",new Date(new Date().getTime())),!r&&z&&u.setValue("starts_at",void 0)},[L,s]);const P=A=>{A.indexOf("ends_at")>-1&&!s?n(!0):A.indexOf("ends_at")===-1&&s&&n(!1),A.indexOf("starts_at")===-1&&r?a(!1):A.indexOf("starts_at")>-1&&!r&&a(!0),A.indexOf("usage_limit")===-1&&C?(h(C),setTimeout(()=>{u.setValue("usage_limit",null)},300)):A.indexOf("usage_limit")>-1&&C&&u.setValue("usage_limit",i),A.indexOf("valid_duration")===-1&&I!==""?(f(I),setTimeout(()=>{u.setValue("valid_duration","")},300)):A.indexOf("valid_duration")>-1&&I===""&&u.setValue("valid_duration",d)},J=()=>{m(pt),u.reset({rule:{type:se.PERCENTAGE,allocation:le.TOTAL}})};return p.useEffect(()=>{J()},[]),e(ms,{...u,children:e(Ot.Provider,{value:{type:c,isDynamic:y,hasExpiryDate:s,setHasExpiryDate:n,hasStartDate:r,setHasStartDate:a,handleConfigurationChanged:P,conditions:o,updateCondition:g,setConditions:m,handleReset:J},children:t})})},Ot=Qe.createContext(null),F=()=>{const t=Qe.useContext(Ot),s=ps();if(!t)throw new Error("useDiscountForm must be a child of DiscountFormContext");return{...s,...t}},Rt=({actions:t,index:s,title:n,description:r})=>l("div",{className:"p-base border rounded-rounded flex gap-base justify-between items-center",children:[l("div",{className:"flex overflow-hidden gap-base w-full",children:[e("div",{children:l(Xe,{className:"inter-base-semibold flex justify-center items-center w-[40px] h-[40px]",variant:"default",children:["ยง",s]})}),l("div",{className:"truncate flex flex-col justify-center flex-1 w-full",children:[e("div",{className:"inter-small-semibold",children:n}),r&&(typeof r=="string"?e("div",{className:"inter-small-regular text-grey-50",children:r}):r)]})]}),t&&e("div",{children:e(_t,{forceDropdown:!0,actions:t})})]}),_e=({row:t})=>e(T.Row,{...t.getRowProps(),children:t.cells.map(s=>e(T.Cell,{...s.getCellProps(),children:s.render("Cell")}))}),Ne=({headerGroup:t})=>e(T.HeadRow,{...t.getHeaderGroupProps(),children:t.headers.map(s=>e(T.HeadCell,{className:"w-[100px]",...s.getHeaderProps(s.getSortByToggleProps()),children:s.render("Header")}))}),we=()=>p.useMemo(()=>[{Header:()=>l("div",{className:"flex items-center gap-1 min-w-[546px]",children:["Title ",e(te,{size:16})]}),accessor:"title",Cell:({row:{original:s}})=>e("span",{children:s.title})},{Header:()=>l("div",{className:"flex justify-end items-center gap-1",children:["Products ",e(te,{size:16})]}),id:"products",accessor:s=>{var n;return(n=s==null?void 0:s.products)==null?void 0:n.length},Cell:({cell:{value:s}})=>e("div",{className:"text-right",children:s})}],[]),E={limit:12,offset:0},U=({value:t,onChange:s})=>l(K.Root,{value:t,onValueChange:s,className:"grid grid-cols-2 gap-base mb-4",children:[e(K.Item,{className:"w-full",label:"In",value:j.IN,description:"Applies to the selected items."}),e(K.Item,{className:"w-full",label:"Not in",value:j.NOT_IN,description:"Applies to all items except the selected items."})]}),De=({type:t,items:s,operator:n,onClose:r})=>{const{pop:a,reset:i}=p.useContext($),{updateCondition:h}=F();return l("div",{className:"w-full flex justify-end gap-x-xsmall",children:[e(_,{variant:"ghost",size:"small",onClick:()=>{r(),i()},children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>{h({type:t,items:s,operator:n}),a()},children:"Save and add more"}),e(_,{variant:"primary",size:"small",onClick:()=>{h({type:t,items:s,operator:n}),r(),i()},children:"Save and close"})]})},Vs=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.product_collections)==null?void 0:u.items)||[]),[i,h]=p.useState(n.product_collections.operator),{isLoading:d,count:f,collections:o}=ge(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=we();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by title..."},resourceName:"Collections",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:_e,renderHeaderGroup:Ne,...s})]}),e(b.Footer,{children:e(De,{type:"product_collections",items:r,onClose:t,operator:i})})]})},Te=({headerGroup:t})=>e(T.HeadRow,{...t.getHeaderGroupProps(),children:t.headers.map(s=>e(T.HeadCell,{className:"w-[100px]",...s.getHeaderProps(s.getSortByToggleProps()),children:s.render("Header")}))}),Pe=({row:t})=>e(T.Row,{...t.getRowProps(),children:t.cells.map(s=>e(T.Cell,{...s.getCellProps(),children:s.render("Cell")}))}),Oe=()=>p.useMemo(()=>[{Header:()=>l("div",{className:"flex items-center gap-1 min-w-[540px]",children:["Title ",e(te,{size:16})]}),accessor:"name"},{Header:()=>l("div",{className:"flex justify-end items-center gap-1",children:["Members ",e(te,{size:16})]}),id:"members",accessor:s=>{var n;return(n=s.customers)==null?void 0:n.length},Cell:({cell:{value:s}})=>e("div",{className:"text-right",children:s})}],[]),Ys=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n==null?void 0:n.customer_groups)==null?void 0:u.items)||[]),[i,h]=p.useState(n.customer_groups.operator),{isLoading:d,count:f,customer_groups:o}=ye(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.name})))},g=Oe();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search groups..."},resourceName:"Customer groups",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Pe,renderHeaderGroup:Te,...s})]}),e(b.Footer,{children:e(De,{type:"customer_groups",items:r,onClose:t,operator:i})})]})},Qs=t=>{switch(t){case"proposed":return"warning";case"published":return"success";case"rejected":return"danger";case"draft":default:return"default"}},Re=({row:t})=>e(T.Row,{...t.getRowProps(),children:t.cells.map(s=>e(T.Cell,{...s.getCellProps(),children:s.render("Cell")}))}),Ee=({headerGroup:t})=>e(T.HeadRow,{...t.getHeaderGroupProps(),children:t.headers.map(s=>e(T.HeadCell,{className:"w-[100px]",...s.getHeaderProps(s.getSortByToggleProps()),children:s.render("Header")}))}),Ie=()=>p.useMemo(()=>[{Header:()=>l("div",{className:"flex items-center gap-1 min-w-[443px]",children:["Title ",e(te,{size:16})]}),accessor:"title",Cell:({row:{original:s}})=>l("div",{className:"flex items-center",children:[e("div",{className:"h-[40px] w-[30px] my-1.5 flex items-center mr-4",children:s.thumbnail?e("img",{src:s.thumbnail,className:"h-full object-cover rounded-soft"}):e(fs,{})}),e("div",{className:"flex flex-col",children:e("span",{children:s.title})})]})},{Header:()=>l("div",{className:"flex items-center gap-1",children:["Status ",e(te,{size:16})]}),accessor:"status",Cell:({row:{original:s}})=>e(ce,{title:`${s.status.charAt(0).toUpperCase()}${s.status.slice(1)}`,variant:Qs(s.status)})},{Header:()=>l("div",{className:"flex justify-end items-center gap-1",children:["Variants ",e(te,{size:16})]}),id:"variants",accessor:s=>s.variants.length,Cell:({cell:{value:s}})=>e("div",{className:"text-right",children:s})}],[]),Js=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.products)==null?void 0:u.items)||[]),[i,h]=p.useState(n.products.operator),{isLoading:d,count:f,products:o}=Ce(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=Ie();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search products..."},resourceName:"Products",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Re,renderHeaderGroup:Ee,...s})]}),e(b.Footer,{children:e(De,{type:"products",items:r,onClose:t,operator:i})})]})},Ae=[{Header:()=>l("div",{className:"flex items-center gap-1",children:["Tag ",e(te,{size:16})]}),accessor:"value",Cell:({row:{original:t}})=>e("div",{className:"w-[220px]",children:l("span",{className:"bg-grey-10 px-2 py-0.5 rounded-rounded",children:["#",t.value]})})}],ke=({headerGroup:t})=>e(T.HeadRow,{...t.getHeaderGroupProps(),children:t.headers.map(s=>e(T.HeadCell,{...s.getHeaderProps(s.getSortByToggleProps()),className:"w-[20px]",children:s.render("Header")}))}),Fe=({row:t})=>e(T.Row,{...t.getRowProps(),children:t.cells.map(s=>e(T.Cell,{...s.getCellProps(),children:s.render("Cell")}))}),Xs=({onClose:t})=>{var g;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((g=n.product_tags)==null?void 0:g.items)||[]),[i,h]=p.useState(n.product_tags.operator),{isLoading:d,count:f,product_tags:o}=be(s.queryObject,{keepPreviousData:!0}),m=u=>{const c=(o==null?void 0:o.filter(y=>u.includes(y.id)))||[];a(c.map(y=>({id:y.id,label:y.value})))};return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by tag..."},resourceName:"Tags",totalCount:f||0,selectedIds:r.map(u=>u.id),data:o,columns:Ae,isLoading:d,onChange:m,renderRow:Fe,renderHeaderGroup:ke,...s})]}),e(b.Footer,{children:e(De,{type:"product_tags",items:r,onClose:t,operator:i})})]})},Me=({row:t})=>e(T.Row,{...t.getRowProps(),children:t.cells.map(s=>e(T.Cell,{...s.getCellProps(),children:s.render("Cell")}))}),He=({headerGroup:t})=>e(T.HeadRow,{...t.getHeaderGroupProps(),children:t.headers.map(s=>e(T.HeadCell,{className:"w-[100px]",...s.getHeaderProps(s.getSortByToggleProps()),children:s.render("Header")}))}),Le=()=>p.useMemo(()=>[{Header:()=>l("div",{className:"flex items-center gap-1 min-w-[626px]",children:["Type ",e(te,{size:16})]}),accessor:"value",Cell:({row:{original:s}})=>e("span",{children:s.value})}],[]),Ws=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.product_types)==null?void 0:u.items)||[]),[i,h]=p.useState(n.product_types.operator),{isLoading:d,count:f,product_types:o}=ve(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.value})))},g=Le();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by type..."},resourceName:"Types",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Me,renderHeaderGroup:He,...s})]}),e(b.Footer,{children:e(De,{type:"product_types",items:r,onClose:t,operator:i})})]})},tt={products:{id:void 0,operator:j.IN,type:S.PRODUCTS,items:[]},product_collections:{id:void 0,operator:j.IN,type:S.PRODUCT_COLLECTIONS,items:[]},product_tags:{id:void 0,operator:j.IN,type:S.PRODUCT_TAGS,items:[]},product_types:{id:void 0,operator:j.IN,type:S.PRODUCT_TYPES,items:[]},customer_groups:{id:void 0,operator:j.IN,type:S.CUSTOMER_GROUPS,items:[]}},Et=p.createContext(null),Zs=({discount:t,children:s})=>{const[n,r]=p.useState(tt),{mutate:a}=de(t.id),i=Y(),h=()=>{if(t.rule.conditions.length){let g=tt;for(const u of t.rule.conditions)g={...g,[u.type]:{...g[u.type],id:u.id}},r(g)}else r(tt)};p.useEffect(()=>{h()},[t]);const d=({type:g,items:u,operator:c})=>{r(y=>({...y,[g]:{...y[g],items:u,operator:c}}))},f=g=>{const u=Object.values(g).filter(c=>c.items.length).map(c=>({[c.type]:c.items.map(y=>y.id),operator:c.operator}));u.length&&a({rule:{id:t.rule.id,conditions:u}},{onSuccess:()=>{i("Condtions were succesfully added","Discount conditions updated","success")},onError:c=>{i("Error",q(c),"error")}})},o=()=>{f(n)},m=({type:g,items:u,operator:c})=>{const y={...n,[g]:{...n[g],items:u,operator:c}};f(y)};return e(Et.Provider,{value:{conditions:n,updateCondition:d,reset:h,save:o,updateAndSave:m},children:s})},oe=()=>{const t=p.useContext(Et);if(t===null)throw new Error("useConditions must be used within a ConditionsProvider");return t},je=({type:t,items:s,operator:n,onClose:r})=>{const{pop:a,reset:i}=p.useContext($),{updateCondition:h,updateAndSave:d}=oe();return l("div",{className:"w-full flex justify-end gap-x-xsmall",children:[e(_,{variant:"ghost",size:"small",onClick:r,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>{h({type:t,items:s,operator:n}),a()},children:"Save and add more"}),e(_,{variant:"primary",size:"small",onClick:()=>{d({type:t,items:s,operator:n}),r(),i()},children:"Save and close"})]})},Ks=({onClose:t})=>{var u;const s=R(E),{conditions:n}=oe(),[r,a]=p.useState(((u=n.product_collections)==null?void 0:u.items)||[]);p.useEffect(()=>{},[n]);const[i,h]=p.useState(n.product_collections.operator),{isLoading:d,count:f,collections:o}=ge(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=we();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by title..."},resourceName:"Collections",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:_e,renderHeaderGroup:Ne,...s})]}),e(b.Footer,{children:e(je,{type:"product_collections",items:r,onClose:t,operator:i})})]})},er=({onClose:t})=>{var u;const s=R(E),{conditions:n}=oe(),[r,a]=p.useState(((u=n==null?void 0:n.customer_groups)==null?void 0:u.items)||[]),[i,h]=p.useState(n.customer_groups.operator),{isLoading:d,count:f,customer_groups:o}=ye(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.name})))},g=Oe();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search groups..."},resourceName:"Customer groups",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Pe,renderHeaderGroup:Te,...s})]}),e(b.Footer,{children:e(je,{type:"customer_groups",items:r,onClose:t,operator:i})})]})},tr=({onClose:t})=>{var u;const s=R(E),{conditions:n}=oe(),[r,a]=p.useState(((u=n.products)==null?void 0:u.items)||[]),[i,h]=p.useState(n.products.operator),{isLoading:d,count:f,products:o}=Ce(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=Ie();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search products..."},resourceName:"Products",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Re,renderHeaderGroup:Ee,...s})]}),e(b.Footer,{children:e(je,{type:"products",items:r,onClose:t,operator:i})})]})},sr=({onClose:t})=>{var g;const s=R(E),{conditions:n}=oe(),[r,a]=p.useState(((g=n.product_tags)==null?void 0:g.items)||[]),[i,h]=p.useState(n.product_tags.operator),{isLoading:d,count:f,product_tags:o}=be(s.queryObject,{keepPreviousData:!0}),m=u=>{const c=(o==null?void 0:o.filter(y=>u.includes(y.id)))||[];a(c.map(y=>({id:y.id,label:y.value})))};return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by tag..."},resourceName:"Tags",totalCount:f||0,selectedIds:r.map(u=>u.id),data:o,columns:Ae,isLoading:d,onChange:m,renderRow:Fe,renderHeaderGroup:ke,...s})]}),e(b.Footer,{children:e(je,{type:"product_tags",items:r,onClose:t,operator:i})})]})},rr=({onClose:t})=>{var u;const s=R(E),{conditions:n}=oe(),[r,a]=p.useState(((u=n.product_types)==null?void 0:u.items)||[]),[i,h]=p.useState(n.product_types.operator),{isLoading:d,count:f,product_types:o}=ve(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.value})))},g=Le();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by type..."},resourceName:"Types",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Me,renderHeaderGroup:He,...s})]}),e(b.Footer,{children:e(je,{type:"product_types",items:r,onClose:t,operator:i})})]})},nr=({isDetails:t,onClose:s})=>{const n=p.useContext($);return p.useMemo(()=>[{label:"Product",value:S.PRODUCTS,description:"Only for specific products",onClick:()=>n.push({title:"Choose products",onBack:()=>n.pop(),view:t?e(tr,{onClose:s}):e(Js,{onClose:s})})},{label:"Customer group",value:S.CUSTOMER_GROUPS,description:"Only for specific customer groups",onClick:()=>{n.push({title:"Choose groups",onBack:()=>n.pop(),view:t?e(er,{onClose:s}):e(Ys,{onClose:s})})}},{label:"Tag",value:S.PRODUCT_TAGS,description:"Only for specific tags",onClick:()=>n.push({title:"Choose tags",onBack:()=>n.pop(),view:t?e(sr,{onClose:s}):e(Xs,{onClose:s})})},{label:"Collection",value:S.PRODUCT_COLLECTIONS,description:"Only for specific product collections",onClick:()=>n.push({title:"Choose collections",onBack:()=>n.pop(),view:t?e(Ks,{onClose:s}):e(Vs,{onClose:s})})},{label:"Type",value:S.PRODUCT_TYPES,description:"Only for specific product types",onClick:()=>n.push({title:"Choose types",onBack:()=>n.pop(),view:t?e(rr,{onClose:s}):e(Ws,{onClose:s})})}],[t])},It=({onClose:t,conditions:s,save:n,isDetails:r=!1})=>{const a=p.useContext($),[i,h]=p.useState(nr({onClose:t,isDetails:r}));return p.useEffect(()=>{const d=[];for(const[f,o]of Object.entries(s))(r?o.id:o.items.length)&&d.push(f);h(i.filter(f=>!d.includes(f.value)))},[s]),e(Ct,{context:a,handleClose:t,children:l(b.Body,{className:"h-[calc(100vh-134px)] flex flex-col",children:[l(b.Header,{handleClose:t,children:[e("span",{className:"inter-xlarge-semibold",children:"Add Conditions"}),l("span",{className:"font-semibold text-grey-90 mt-6 flex items-center gap-1",children:["Choose a condition type"," ",e(at,{content:"You can only add one of each type of condition"})]})]}),e(b.Content,{className:"flex-1",children:i.length?i.map(d=>e(ar,{...d},d.value)):e("div",{className:"flex flex-col items-center justify-center flex-1 h-full",children:e("span",{className:"inter-base-regular text-grey-40",children:"Can't add anymore conditions"})})}),e(b.Footer,{children:l("div",{className:"flex w-full h-8 justify-end",children:[e(_,{variant:"ghost",className:"mr-2 w-32 text-small justify-center",size:"small",onClick:t,children:"Cancel"}),e(_,{onClick:()=>{n&&n(),t()},size:"small",className:"w-32 text-small justify-center",variant:"primary",children:"Save"})]})})]})})},ar=t=>{const{label:s,description:n,onClick:r}=t;return l("button",{onClick:r,className:"rounded-lg border border-1 p-4 mb-2 cursor-pointer hover:bg-grey-5 transition-all w-full flex items-center justify-between",children:[l("div",{className:"flex flex-col items-start",children:[e("div",{className:"font-semibold ",children:s}),e("div",{className:"text-grey-50",children:n})]}),e(cs,{width:16,height:32,className:"text-grey-50"})]})},or=({show:t,onClose:s})=>{const{conditions:n,save:r,reset:a}=oe();return e("div",{children:t&&e(It,{isDetails:!0,onClose:()=>{s(),a()},conditions:n,save:r})})},At=p.createContext(null),ir=({condition:t,discount:s,onClose:n,children:r})=>{const a=Y(),{pop:i,reset:h}=p.useContext($),d=$t(s.id,t.id),f=Bt(s.id,t.id),o=(c,y)=>{d.mutate({resources:c.map(C=>({id:C}))},{onSuccess:()=>{a("Success","The resources were successfully added","success"),y==null||y()},onError:()=>a("Error","Failed to add resources","error")})},m=c=>{f.mutate({resources:c.map(y=>({id:y}))},{onSuccess:()=>{a("Success","The resources were successfully removed","success")},onError:()=>a("Error","Failed to remove resources","error")})};function g(c){o(c,()=>n()),h()}function u(c){o(c),i()}return e(At.Provider,{value:{condition:t,discount:s,removeConditionResources:m,saveAndClose:g,saveAndGoBack:u,isLoading:d.isLoading||f.isLoading},children:r})},Q=()=>{const t=p.useContext(At);if(t===null)throw new Error("useEditConditionContext must be used within an EditConditionProvider");return t},cr=()=>{const t=R(E),{pop:s}=p.useContext($),[n,r]=p.useState([]),a=we(),{isLoading:i,count:h,collections:d,refetch:f}=ge(t.queryObject,{keepPreviousData:!0}),{saveAndClose:o,saveAndGoBack:m}=Q();return l(D,{children:[e(b.Content,{children:e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search..."},resourceName:"Collections",totalCount:h??0,selectedIds:n,data:d||[],columns:a,isLoading:i,onChange:g=>r(g),renderRow:_e,renderHeaderGroup:Ne,...t})}),e(b.Footer,{children:l("div",{className:"flex justify-end w-full space-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>m(n,()=>f()),children:"Save and go back"}),e(_,{variant:"primary",size:"small",onClick:()=>o(n),children:"Save and close"})]})})]})},lr=()=>{const t=R(E),{pop:s}=p.useContext($),[n,r]=p.useState([]),a=Oe(),{isLoading:i,count:h,customer_groups:d,refetch:f}=ye(t.queryObject,{keepPreviousData:!0}),{saveAndClose:o,saveAndGoBack:m}=Q();return l(D,{children:[e(b.Content,{children:e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search..."},resourceName:"Groups",totalCount:h??0,selectedIds:n,data:d||[],columns:a,isLoading:i,onChange:g=>r(g),renderRow:Pe,renderHeaderGroup:Te,...t})}),e(b.Footer,{children:l("div",{className:"flex justify-end w-full space-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>m(n,()=>f()),children:"Save and go back"}),e(_,{variant:"primary",size:"small",onClick:()=>o(n),children:"Save and close"})]})})]})},dr=()=>{const t=R(E),{pop:s}=p.useContext($),[n,r]=p.useState([]),a=Le(),{isLoading:i,count:h,product_types:d,refetch:f}=ve(t.queryObject,{keepPreviousData:!0}),{saveAndClose:o,saveAndGoBack:m}=Q();return l(D,{children:[e(b.Content,{children:e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search..."},resourceName:"Types",totalCount:h??0,selectedIds:n,data:d||[],columns:a,isLoading:i,onChange:g=>r(g),renderRow:Me,renderHeaderGroup:He,...t})}),e(b.Footer,{children:l("div",{className:"flex justify-end w-full space-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>m(n,()=>f()),children:"Save and go back"}),e(_,{variant:"primary",size:"small",onClick:()=>o(n),children:"Save and close"})]})})]})},ur=()=>{const t=R(E),{pop:s}=p.useContext($),[n,r]=p.useState([]),a=Ie(),{isLoading:i,count:h,products:d}=Ce(t.queryObject,{keepPreviousData:!0}),{saveAndClose:f,saveAndGoBack:o}=Q();return l(D,{children:[e(b.Content,{children:e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search..."},resourceName:"Products",totalCount:h??0,selectedIds:n,data:d||[],columns:a,isLoading:i,onChange:m=>r(m),renderRow:Re,renderHeaderGroup:Ee,...t})}),e(b.Footer,{children:l("div",{className:"flex justify-end w-full space-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>o(n),children:"Save and go back"}),e(_,{variant:"primary",size:"small",onClick:()=>f(n),children:"Save and close"})]})})]})},mr=()=>{const t=R(E),{pop:s}=p.useContext($),[n,r]=p.useState([]),{isLoading:a,count:i,product_tags:h}=be(t.queryObject,{keepPreviousData:!0}),{saveAndClose:d,saveAndGoBack:f}=Q();return l(D,{children:[e(b.Content,{children:e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search..."},resourceName:"Tags",totalCount:i??0,selectedIds:n,data:h||[],columns:Ae,isLoading:a,onChange:o=>r(o),renderRow:Fe,renderHeaderGroup:ke,...t})}),e(b.Footer,{children:l("div",{className:"flex justify-end w-full space-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",onClick:()=>f(n),children:"Save and go back"}),e(_,{variant:"primary",size:"small",onClick:()=>d(n),children:"Save and close"})]})})]})},pr=t=>{const{pop:s}=Qe.useContext($);return{title:"Add conditions",onBack:s,view:(()=>{switch(t.type){case"products":return e(ur,{});case"product_collections":return e(cr,{});case"product_types":return e(dr,{});case"product_tags":return e(mr,{});case"customer_groups":return e(lr,{})}})()}},Ue=({numberOfSelectedRows:t,onDeselect:s,onRemove:n})=>{const{condition:r}=Q(),a=pr(r),i=!!t,h={"translate-y-[-42px]":!i,"translate-y-[0px]":i},{push:d}=p.useContext($);return e("div",{className:"flex space-x-xsmall h-[34px] overflow-hidden",children:l("div",{className:ee("transition-all duration-200",h),children:[l("div",{className:"divide-x flex items-center h-[34px] mb-2",children:[l("span",{className:"mr-3 inter-small-regular text-grey-50",children:[t," selected"]}),l("div",{className:"flex space-x-xsmall pl-3",children:[e(_,{onClick:s,size:"small",variant:"ghost",className:"border border-grey-20",children:"Deselect"}),e(_,{onClick:n,size:"small",variant:"ghost",className:"border border-grey-20 text-rose-50",children:"Remove"})]})]}),e("div",{className:"flex justify-end h-[34px]",children:l(_,{size:"small",variant:"ghost",className:"border border-grey-20",onClick:()=>d(a),children:[e(Se,{size:20})," Add"]})})]})})},hr=()=>{const t=R(E),[s,n]=p.useState([]),{condition:r,removeConditionResources:a,isLoading:i}=Q(),{isLoading:h,count:d,products:f,refetch:o}=Ce({discount_condition_id:r.id,...t.queryObject},{keepPreviousData:!0}),m=Ie(),g=()=>{n([])},u=()=>{a(s),g()};return p.useEffect(()=>{i||(o(),g())},[i]),e(b.Content,{children:e(O,{options:{enableSearch:!1,tableActions:e(Ue,{numberOfSelectedRows:s.length,onDeselect:g,onRemove:u})},resourceName:"Products",totalCount:d??0,selectedIds:s,data:f||[],columns:m,isLoading:h,onChange:c=>n(c),renderRow:Re,renderHeaderGroup:Ee,...t})})},fr=()=>{const t=R(E),[s,n]=p.useState([]),{condition:r,removeConditionResources:a,isLoading:i}=Q(),{isLoading:h,count:d,collections:f,refetch:o}=ge({discount_condition_id:r.id,...t.queryObject},{keepPreviousData:!0}),m=we(),g=()=>{n([])},u=()=>{a(s),g()};return p.useEffect(()=>{i||(o(),g())},[i]),e(b.Content,{children:e(O,{options:{enableSearch:!1,tableActions:e(Ue,{numberOfSelectedRows:s.length,onDeselect:g,onRemove:u,deleting:i})},resourceName:"Collections",totalCount:d??0,selectedIds:s,data:f||[],columns:m,isLoading:h,onChange:c=>n(c),renderRow:_e,renderHeaderGroup:Ne,...t})})},gr=()=>{const t=R(E),{condition:s,removeConditionResources:n,isLoading:r}=Q(),{isLoading:a,count:i,product_types:h,refetch:d}=ve({discount_condition_id:s.id,...t.queryObject},{keepPreviousData:!0}),f=Le(),[o,m]=p.useState([]),g=()=>{m([])},u=()=>{n(o),g()};return p.useEffect(()=>{r||(d(),g())},[r]),e(b.Content,{children:e(O,{options:{enableSearch:!1,tableActions:e(Ue,{numberOfSelectedRows:o.length,onDeselect:g,onRemove:u,deleting:r})},resourceName:"Types",totalCount:i??0,selectedIds:o,data:h||[],columns:f,isLoading:a,onChange:c=>m(c),renderRow:Me,renderHeaderGroup:He,...t})})},yr=()=>{const t=R(E),{condition:s,removeConditionResources:n,isLoading:r}=Q(),{isLoading:a,count:i,product_tags:h,refetch:d}=be({discount_condition_id:s.id,...t.queryObject},{keepPreviousData:!0}),[f,o]=p.useState([]),m=()=>{o([])},g=()=>{n(f),m()};return p.useEffect(()=>{r||(d(),m())},[r]),e(b.Content,{children:e(O,{options:{enableSearch:!1,tableActions:e(Ue,{numberOfSelectedRows:f.length,onDeselect:m,onRemove:g,deleting:r})},resourceName:"Tags",totalCount:i??0,selectedIds:f,data:h||[],columns:Ae,isLoading:a,onChange:u=>o(u),renderRow:Fe,renderHeaderGroup:ke,...t})})},Cr=()=>{const t=R(E),{condition:s,removeConditionResources:n,isLoading:r}=Q(),{isLoading:a,count:i,customer_groups:h,refetch:d}=ye({discount_condition_id:s.id,...t.queryObject},{keepPreviousData:!0}),f=Oe(),[o,m]=p.useState([]),g=()=>{m([])},u=()=>{n(o),g()};return p.useEffect(()=>{r||(d(),g())},[r]),e(b.Content,{children:e(O,{options:{enableSearch:!1,tableActions:e(Ue,{numberOfSelectedRows:o.length,onDeselect:g,onRemove:u,deleting:r})},resourceName:"Groups",totalCount:i??0,selectedIds:o,data:h||[],columns:f,isLoading:a,onChange:c=>m(c),renderRow:Pe,renderHeaderGroup:Te,...t})})},kt=t=>{switch(t){case"products":return"products";case"customer_groups":return"groups";case"product_tags":return"tags";case"product_collections":return"collections";case"product_types":return"types"}},br=({open:t,condition:s,discount:n,onClose:r})=>{const a=p.useContext($),i=()=>{switch(s.type){case"products":return e(hr,{});case"product_collections":return e(fr,{});case"product_types":return e(gr,{});case"product_tags":return e(yr,{});case"customer_groups":return e(Cr,{})}};return e(ir,{condition:s,discount:n,onClose:r,children:e(Ct,{open:t,handleClose:r,context:a,children:l(b.Body,{children:[e(b.Header,{handleClose:r,children:l("h1",{className:"inter-xlarge-semibold",children:["Edit ",$e.capitalize(kt(s==null?void 0:s.type))," in Discount Condition"]})}),i(),e(b.Footer,{children:e("div",{className:"flex items-center justify-end w-full",children:e(_,{variant:"primary",size:"small",type:"button",onClick:r,children:"Close"})})})]})})})},vr=t=>{const[s,n]=p.useState(null),{refetch:r}=bt(t.id),{discount_condition:a}=vt(t.id,s,{expand:"product_collections,product_tags,product_types,customer_groups,products"},{enabled:!!s,cacheTime:0}),{mutate:i}=Vt(t.id),h=Y(),d=m=>{i(m,{onSuccess:()=>{h("Success","Condition removed","success"),r()},onError:g=>{h("Error",q(g),"error")}})},f=t.rule.conditions.map(m=>({type:m.type,title:Sr(m.type),description:xr(m.type),actions:[{label:"Edit condition",icon:e(xe,{size:16}),variant:"ghost",onClick:()=>n(m.id)},{label:"Delete condition",icon:e(ne,{size:16}),variant:"danger",onClick:()=>d(m.id)}]}));function o(){n(null)}return{conditions:f,selectedCondition:a,deSelectCondition:o}},Sr=t=>{switch(t){case S.PRODUCTS:return"Product";case S.PRODUCT_COLLECTIONS:return"Collection";case S.PRODUCT_TAGS:return"Tag";case S.PRODUCT_TYPES:return"Type";case S.CUSTOMER_GROUPS:return"Customer Group"}},xr=t=>{switch(t){case S.PRODUCTS:return"Discount is applicable to specific products";case S.PRODUCT_COLLECTIONS:return"Discount is applicable to specific collections";case S.PRODUCT_TAGS:return"Discount is applicable to specific product tags";case S.PRODUCT_TYPES:return"Discount is applicable to specific product types";case S.CUSTOMER_GROUPS:return"Discount is applicable to specific customer groups"}},_r=({discount:t})=>{const[s,n]=p.useState(!1),{conditions:r,selectedCondition:a,deSelectCondition:i}=vr(t);return l(Zs,{discount:t,children:[e(Je,{title:"Conditions",className:"min-h-[200px]",forceDropdown:!0,actionables:[{label:"Add condition",icon:e(Se,{size:16}),onClick:()=>n(!0)}],children:r.length?e("div",{style:{gridTemplateRows:`repeat(${Math.ceil((r==null?void 0:r.length)/2)}, minmax(0, 1fr))`},className:"grid grid-cols-2 grid-flow-col gap-y-base gap-x-xlarge",children:r.map((h,d)=>e(Rt,{title:h.title,index:d+1,description:h.description,actions:h.actions},d))}):e("div",{className:"flex flex-col justify-center items-center flex-1 gap-y-small",children:e("span",{className:"inter-base-regular text-grey-50",children:"This discount has no conditions"})})}),e(or,{show:s,onClose:()=>n(!1)}),a&&e(br,{open:!!a,condition:a,discount:t,onClose:()=>i()})]})},pe=t=>parseFloat(t.target.value),Ft=({value:t,onChange:s})=>{const n=t?it(t):{},[r,a]=p.useState(n.years||0),[i,h]=p.useState(n.months||0),[d,f]=p.useState(n.days||0),[o,m]=p.useState(n.hours||0),[g,u]=p.useState(n.minutes||0);return p.useEffect(()=>{const c=`P${r||0}Y${i||0}M${d||0}DT${o||0}H${g||0}M`;s(c)},[r,i,d,o,g]),e("div",{children:l("div",{className:"grid grid-cols-3 grid-rows-2 gap-x-xsmall gap-y-base mt-xlarge",children:[e(V,{label:"Years",type:"number",placeholder:"0",value:r,onChange:c=>a(pe(c)),min:0}),e(V,{label:"Months",type:"number",placeholder:"0",value:i,onChange:c=>h(pe(c)),min:0}),e(V,{label:"Days",type:"number",placeholder:"0",value:d,onChange:c=>f(pe(c)),min:0}),e(V,{label:"Hours",type:"number",placeholder:"0",value:o,onChange:c=>m(pe(c)),min:0}),e(V,{label:"Minutes",type:"number",placeholder:"0",value:g,onChange:c=>u(pe(c)),min:0})]})})},qe=({title:t,description:s,tooltip:n,open:r=!1,onSwitch:a,children:i})=>l("div",{children:[l("div",{className:"flex items-start justify-between",children:[l("div",{className:"flex flex-col",children:[l("div",{className:"flex items-center gap-x-2xsmall",children:[e("p",{className:"inter-base-semibold",children:t}),n&&e(at,{content:n})]}),e("p",{className:"inter-small-regular text-grey-50 mt-1",children:s})]}),e(he,{checked:r,onClick:a,type:"button",className:"cursor-pointer"})]}),e("div",{className:ee("transition-[max-height,opacity] duration-500 ease-in-out overflow-hidden",{"max-h-[1000px] opacity-100":r,"max-h-0 opacity-0":!r}),children:e("div",{className:"mt-base",children:i})})]}),Nr=({discount:t,onClose:s})=>{const{mutate:n,isLoading:r}=de(t.id),a=Y(),{control:i,handleSubmit:h,reset:d}=ot({defaultValues:st(t)}),f=o=>{n({starts_at:o.starts_at??new Date,ends_at:o.ends_at,usage_limit:o.usage_limit&&o.usage_limit>0?o.usage_limit:null,valid_duration:o.valid_duration},{onSuccess:({discount:m})=>{a("Success","Discount updated successfully","success"),d(st(m)),s()},onError:m=>{a("Error",q(m),"error")}})};return p.useEffect(()=>{d(st(t))},[t]),e(b,{handleClose:s,isLargeModal:!0,children:l(b.Body,{children:[e(b.Header,{handleClose:s,children:e("h1",{className:"inter-xlarge-semibold",children:"Edit configurations"})}),l("form",{onSubmit:h(f),children:[e(b.Content,{children:l("div",{className:"flex flex-col gap-y-xlarge",children:[e(G,{name:"starts_at",defaultValue:t.starts_at,control:i,render:({field:{onChange:o,value:m}})=>e(qe,{open:!!m,onSwitch:()=>{o(m?null:new Date(t.starts_at))},title:"Discount has a start date?",description:"Schedule the discount to activate in the future.",children:l("div",{className:"flex gap-x-xsmall items-center",children:[e(Be,{date:m,label:"Start date",onSubmitDate:o}),e(Ve,{label:"Start time",date:m,onSubmitDate:o})]})})}),e(G,{name:"ends_at",control:i,render:({field:{value:o,onChange:m}})=>e(qe,{open:!!o,onSwitch:()=>{m(o?null:new Date(new Date().getTime()+7*24*60*60*1e3))},title:"Discount has an expiry date?",description:"Schedule the discount to deactivate in the future.",children:l("div",{className:"flex gap-x-xsmall items-center",children:[e(Be,{date:o,label:"Expiry date",onSubmitDate:m}),e(Ve,{label:"Expiry time",date:o,onSubmitDate:m})]})})}),e(G,{name:"usage_limit",control:i,render:({field:{value:o,onChange:m}})=>e(qe,{open:!!o,onSwitch:()=>{m(o?null:10)},title:"Limit the number of redemtions?",description:"Limit applies across all customers, not per customer.",children:e(V,{label:"Number of redemptions",type:"number",placeholder:"5",min:1,defaultValue:o??void 0,onChange:g=>m(g.target.valueAsNumber)})})}),t.is_dynamic&&e(G,{name:"valid_duration",control:i,render:({field:{onChange:o,value:m}})=>e(qe,{open:!!m,onSwitch:()=>{o(m?null:"P0Y0M0DT00H00M")},title:"Availability duration?",description:"Set the duration of the discount.",children:e(Ft,{value:m??void 0,onChange:o})})})]})}),e(b.Footer,{children:l("div",{className:"gap-x-xsmall flex items-center justify-end w-full",children:[e(_,{variant:"ghost",size:"small",className:"min-w-[128px]",type:"button",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",className:"min-w-[128px]",type:"submit",loading:r,disabled:r,children:"Save"})]})})]})]})})},st=t=>({starts_at:new Date(t.starts_at),ends_at:t.ends_at?new Date(t.ends_at):null,usage_limit:t.usage_limit,valid_duration:t.valid_duration}),ht=({date:t})=>l("div",{className:"flex text-grey-50 inter-small-regular ",children:[ut.utc(t).format("ddd, DD MMM YYYY"),l("span",{className:"flex items-center ml-3",children:[e(hs,{size:16}),e("span",{className:"ml-2.5",children:ut.utc(t).format("UTC HH:mm")})]})]}),ft=({text:t})=>e("span",{className:"text-grey-50 inter-small-regular",children:t}),wr=t=>{const s=de(t.id),n=Y(),r=[];return r.push({title:"Start date",description:e(ht,{date:t.starts_at})}),t.ends_at&&r.push({title:"End date",description:e(ht,{date:t.ends_at}),actions:[{label:"Delete configuration",icon:e(ne,{size:20}),variant:"danger",onClick:async()=>await s.mutateAsync({ends_at:null},{onSuccess:()=>{n("Success","Discount end date removed","success")},onError:a=>{n("Error",q(a),"error")}})}]}),t.usage_limit&&r.push({title:"Number of redemptions",description:e(ft,{text:t.usage_limit.toLocaleString("en")}),actions:[{label:"Delete configuration",icon:e(ne,{size:20}),variant:"danger",onClick:async()=>await s.mutateAsync({usage_limit:null},{onSuccess:()=>{n("Success","Redemption limit removed","success")},onError:a=>{n("Error",q(a),"error")}})}]}),t.valid_duration&&r.push({title:"Duration",description:e(ft,{text:Object.entries(Dt(it(t.valid_duration))).map(([a,i])=>`${i} ${a}`).join(", ")}),actions:[{label:"Delete setting",icon:e(ne,{size:20}),variant:"danger",onClick:async()=>await s.mutateAsync({valid_duration:null},{onSuccess:()=>{n("Success","Discount duration removed","success")},onError:a=>{n("Error",q(a),"error")}})}]}),r},Dr=({discount:t})=>{const s=wr(t),[n,r]=p.useState(!1);return l(D,{children:[e(Je,{title:"Configurations",className:"min-h-[200px]",actionables:[{label:"Edit configurations",onClick:()=>r(!0),icon:e(xe,{size:20})}],forceDropdown:!0,children:e("div",{style:{gridTemplateRows:`repeat(${Math.ceil(s.length/2)}, minmax(0, 1fr))`},className:"grid grid-cols-2 grid-flow-col gap-y-base gap-x-xlarge",children:s.map((a,i)=>e(Rt,{title:a.title,index:i+1,description:a.description,actions:a.actions},i))})}),n&&e(Nr,{discount:t,onClose:()=>r(!1)})]})},Tr=({discount:t,onClose:s})=>{const{mutate:n,isLoading:r}=de(t.id),a=Y(),{control:i,handleSubmit:h,reset:d,register:f}=ot({defaultValues:rt(t)}),o=C=>{n({regions:C.regions.map(I=>I.value),code:C.code,rule:{id:t.rule.id,description:C.description,value:C.value,allocation:t.rule.allocation}},{onSuccess:({discount:I})=>{a("Success","Discount updated successfully","success"),d(rt(I)),s()},onError:I=>{a("Error",q(I),"error")}})};p.useEffect(()=>{d(rt(t))},[t]);const m=t.rule.type,{regions:g}=St(),u=p.useMemo(()=>g?g.map(C=>({label:C.name,value:C.id})):[],[g]),c=We({control:i,name:"regions"}),y=p.useMemo(()=>{var C;if(m==="fixed"&&(c!=null&&c.length))return(C=g==null?void 0:g.find(I=>I.id===c[0].value))==null?void 0:C.currency_code},[c,m,g]);return e(b,{handleClose:s,children:e("form",{onSubmit:h(o),children:l(b.Body,{children:[e(b.Header,{handleClose:s,children:e("h1",{className:"inter-xlarge-semibold",children:"Edit general information"})}),l(b.Content,{children:[e(G,{name:"regions",control:i,rules:{required:"Atleast one region is required",validate:C=>Array.isArray(C)?C.length>0:!!C},render:({field:{value:C,onChange:I}})=>e(Tt,{value:C,onChange:L=>{I(m==="fixed"?[L]:L)},label:"Choose valid regions",isMulti:m!=="fixed",selectAll:m!=="fixed",isSearchable:!0,required:!0,options:u})}),l("div",{className:"flex gap-x-base gap-y-base my-base",children:[e(V,{label:"Code",className:"flex-1",placeholder:"SUMMERSALE10",required:!0,...f("code",{required:"Code is required"})}),m!=="free_shipping"&&e(D,{children:m==="fixed"?e("div",{className:"flex-1",children:e(Ye.Root,{size:"small",currentCurrency:y??"USD",readOnly:!0,hideCurrency:!0,children:e(G,{name:"value",control:i,rules:{required:"Amount is required",min:1},render:({field:{value:C,onChange:I}})=>e(Ye.Amount,{label:"Amount",required:!0,amount:C,onChange:I})})})}):e("div",{className:"flex-1",children:e(V,{label:"Percentage",min:0,required:!0,type:"number",placeholder:"10",prefix:"%",...f("value",{required:"Percentage is required",valueAsNumber:!0})})})})]}),l("div",{className:"text-grey-50 inter-small-regular flex flex-col mb-6",children:[e("span",{children:"The code your customers will enter during checkout. This will appear on your customerโs invoice."}),e("span",{children:"Uppercase letters and numbers only."})]}),e(Pt,{label:"Description",required:!0,placeholder:"Summer Sale 2022",rows:1,...f("description",{required:"Description is required"})})]}),e(b.Footer,{children:l("div",{className:"gap-x-xsmall flex items-center justify-end w-full",children:[e(_,{variant:"ghost",size:"small",className:"min-w-[128px]",type:"button",onClick:s,children:"Cancel"}),e(_,{variant:"primary",size:"small",className:"min-w-[128px]",type:"submit",disabled:r,loading:r,children:"Save"})]})})]})})})},rt=t=>({regions:t.regions.map(s=>({label:s.name,value:s.id})),code:t.code,description:t.rule.description,value:t.rule.value}),Pr=({discount:t})=>{const s=wt(),n=fe(),r=Y(),a=de(t.id),i=nt(t.id),[h,d]=p.useState(!1),f=async()=>{await s({heading:"Delete Promotion",text:"Are you sure you want to delete this promotion?"})&&i.mutate(void 0,{onSuccess:()=>{r("Success","Promotion deleted successfully","success"),n("/a/discounts/")},onError:u=>{r("Error",q(u),"error")}})},o=async()=>{a.mutate({is_disabled:!t.is_disabled},{onSuccess:({discount:{is_disabled:g}})=>{r("Success",`Discount ${g?"drafted":"published"} successfully`,"success")},onError:g=>{r("Error",q(g),"error")}})};return l(D,{children:[e(Je,{actionables:[{label:"Edit general information",onClick:()=>d(!0),icon:e(xe,{size:20})},{label:"Delete discount",onClick:f,variant:"danger",icon:e(ne,{size:20})}],title:t.code,subtitle:t.rule.description,forceDropdown:!0,className:"min-h-[200px]",status:l("div",{className:"flex items-center gap-x-2xsmall",children:[t.is_dynamic&&e("span",{children:e(Xe,{variant:"default",children:e("span",{className:"text-grey-90 inter-small-regular",children:"Template discount"})})}),e(gs,{isDraft:t==null?void 0:t.is_disabled,activeState:"Published",draftState:"Draft",onChange:o})]}),children:l("div",{className:"flex",children:[l("div",{className:"border-l border-grey-20 pl-6",children:[Or(t),e("span",{className:"inter-small-regular text-grey-50",children:"Discount Amount"})]}),l("div",{className:"border-l border-grey-20 pl-6 ml-12",children:[e("h2",{className:"inter-xlarge-regular text-grey-90",children:t.regions.length.toLocaleString("en-US")}),e("span",{className:"inter-small-regular text-grey-50",children:"Valid Regions"})]}),l("div",{className:"border-l border-grey-20 pl-6 ml-12",children:[e("h2",{className:"inter-xlarge-regular text-grey-90",children:t.usage_count.toLocaleString("en-US")}),e("span",{className:"inter-small-regular text-grey-50",children:"Total Redemptions"})]})]})}),h&&e(Tr,{discount:t,onClose:()=>d(!1)})]})},Or=t=>{switch(t.rule.type){case"fixed":return l("div",{className:"flex items-baseline",children:[e("h2",{className:"inter-xlarge-regular",children:Nt({currency:t.regions[0].currency_code,amount:t.rule.value})}),e("span",{className:"inter-base-regular text-grey-50 ml-1",children:t.regions[0].currency_code.toUpperCase()})]});case"percentage":return l("div",{className:"flex items-baseline",children:[e("h2",{className:"inter-xlarge-regular text-grey-90",children:t.rule.value}),e("span",{className:"inter-base-regular text-grey-50 ml-1",children:"%"})]});case"free_shipping":return e("h2",{className:"inter-xlarge-regular text-grey-90",children:"FREE SHIPPING"});default:return"Unknown discount type"}},Rr=()=>{const{id:t}=Yt(),{discount:s,isLoading:n}=bt(t,{expand:"rule,rule.conditions"},{enabled:!!t}),[r,a]=p.useState(!1),i=nt(t),h=Y(),d=()=>{i.mutate(void 0,{onSuccess:()=>{h("Success","Discount deleted","success")},onError:f=>{h("Error",q(f),"error")}})};return l("div",{className:"pb-xlarge",children:[r&&e(ds,{handleClose:()=>a(!r),onDelete:async()=>d(),successText:"Discount deleted",confirmText:"Yes, delete",text:"Are you sure you want to delete this discount?",heading:"Delete discount"}),e(ls,{currentPage:"Add Discount",previousBreadcrumb:"Discount",previousRoute:"/a/discounts"}),n||!s?e("div",{className:"h-full flex items-center justify-center",children:e(xt,{variant:"secondary"})}):e("div",{className:"flex flex-col gap-y-4",children:l(ct,{children:[e(Pr,{discount:s}),e(Dr,{discount:s}),e(_r,{discount:s}),e(us,{data:s,title:"Raw discount",rootName:"discount"})]})})]})},Er=t=>{const s=[];for(const[n,r]of Object.entries(t))r&&r.items.length&&s.push({operator:r.operator,[n]:r.items.map(a=>a.id)});if(s.length)return s},gt=(t,s)=>{var n,r;return{code:t.code,rule:{allocation:t.rule.type===se.FIXED?t.rule.allocation:le.TOTAL,type:t.rule.type,value:t.rule.type!=="free_shipping"?t.rule.value:0,description:t.rule.description,conditions:Er(s)},is_dynamic:t.is_dynamic,ends_at:t.ends_at??void 0,regions:(n=t.regions)==null?void 0:n.map(a=>a.value),starts_at:t.starts_at,usage_limit:t.usage_limit&&t.usage_limit>0?t.usage_limit:void 0,valid_duration:t.is_dynamic&&((r=t.valid_duration)!=null&&r.length)?t.valid_duration:void 0}},Ir=()=>{const t=fe(),s=yt(),{conditions:n}=F();return{onSaveAsInactive:async i=>{await s.mutateAsync({...gt(i,n),is_disabled:!0},{onSuccess:()=>{t("/a/discounts")}})},onSaveAsActive:async i=>{await s.mutateAsync({...gt(i,n),is_disabled:!1},{onSuccess:()=>{t("/a/discounts")}})}}},ze=({type:t,items:s,operator:n,onClose:r})=>{const{updateCondition:a}=F();return l("div",{className:"flex items-center justify-end w-full gap-x-xsmall",children:[e(_,{variant:"secondary",size:"small",onClick:r,children:"Cancel"}),e(_,{variant:"danger",size:"small",onClick:()=>{a({type:t,items:[],operator:j.IN}),r()},children:"Delete condition"}),e(_,{variant:"primary",size:"small",onClick:()=>{a({type:t,items:s,operator:n}),r()},className:"min-w-[128px]",children:"Save"})]})},Ar=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.product_collections)==null?void 0:u.items)||[]),[i,h]=p.useState(n.product_collections.operator),{isLoading:d,count:f,collections:o}=ge(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=we();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by title...",filters:[{title:"Title",name:"title"}]},resourceName:"Collections",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:_e,renderHeaderGroup:Ne,...s})]}),e(b.Footer,{children:e(ze,{type:"product_collections",items:r,operator:i,onClose:t})})]})},kr=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.customer_groups)==null?void 0:u.items)||[]),[i,h]=p.useState(n.customer_groups.operator),{isLoading:d,count:f,customer_groups:o}=ye(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.name})))},g=Oe();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search groups..."},resourceName:"Customer groups",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Pe,renderHeaderGroup:Te,...s})]}),e(b.Footer,{children:e(ze,{type:"customer_groups",items:r,operator:i,onClose:t})})]})},Fr=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.products)==null?void 0:u.items)||[]),[i,h]=p.useState(n.products.operator),{isLoading:d,count:f,products:o}=Ce(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.title})))},g=Ie();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search products..."},resourceName:"Products",totalCount:f||0,selectedIds:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Re,renderHeaderGroup:Ee,...s})]}),e(b.Footer,{children:e(ze,{type:"products",items:r,operator:i,onClose:t})})]})},Mr=({onClose:t})=>{var g;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((g=n.product_tags)==null?void 0:g.items)||[]),[i,h]=p.useState(n.product_tags.operator),{isLoading:d,count:f,product_tags:o}=be(s.queryObject,{keepPreviousData:!0}),m=u=>{const c=(o==null?void 0:o.filter(y=>u.includes(y.id)))||[];a(c.map(y=>({id:y.id,label:y.value})))};return l(D,{children:[e(b.Content,{children:d?e(xt,{}):l(D,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by tag..."},resourceName:"Tags",totalCount:f||0,selectedIds:r.map(u=>u.id),data:o,columns:Ae,isLoading:d,onChange:m,renderRow:Fe,renderHeaderGroup:ke,...s})]})}),e(b.Footer,{children:e(ze,{type:"product_tags",items:r,operator:i,onClose:t})})]})},Hr=({onClose:t})=>{var u;const s=R(E),{conditions:n}=F(),[r,a]=p.useState(((u=n.product_types)==null?void 0:u.items)||[]),[i,h]=p.useState(n.product_types.operator),{isLoading:d,count:f,product_types:o}=ve(s.queryObject,{keepPreviousData:!0}),m=c=>{const y=(o==null?void 0:o.filter(C=>c.includes(C.id)))||[];a(y.map(C=>({id:C.id,label:C.value})))},g=Le();return l(D,{children:[l(b.Content,{children:[e(U,{value:i,onChange:h}),e(O,{options:{enableSearch:!0,immediateSearchFocus:!0,searchPlaceholder:"Search by type..."},resourceName:"Types",totalCount:f||0,selectedIds:r==null?void 0:r.map(c=>c.id),data:o,columns:g,isLoading:d,onChange:m,renderRow:Me,renderHeaderGroup:He,...s})]}),e(b.Footer,{children:e(ze,{type:"product_types",items:r,operator:i,onClose:t})})]})},Lr=({onClose:t,view:s})=>l(b,{open:!0,handleClose:t,children:[e(b.Header,{handleClose:t,children:l("h1",{className:"inter-xlarge-semibold",children:["Edit ",kt(s)]})}),e(b.Body,{children:e(jr,{view:s,onClose:t})})]}),jr=({view:t,onClose:s})=>{switch(t){case S.PRODUCTS:return e(Fr,{onClose:s});case S.CUSTOMER_GROUPS:return e(kr,{onClose:s});case S.PRODUCT_COLLECTIONS:return e(Ar,{onClose:s});case S.PRODUCT_TAGS:return e(Mr,{onClose:s});case S.PRODUCT_TYPES:return e(Hr,{onClose:s})}},Ur=({index:t,discountId:s,conditionId:n,type:r,setCondition:a,items:i})=>{const h=p.useMemo(()=>{switch(r){case S.PRODUCTS:return{expand:"products"};case S.PRODUCT_COLLECTIONS:return{expand:"product_collections"};case S.PRODUCT_TAGS:return{expand:"product_tags"};case S.CUSTOMER_GROUPS:return{expand:"customer_groups"};case S.PRODUCT_TYPES:return{expand:"product_types"}}},[r]),{discount_condition:d}=vt(s,n,h,{enabled:!!s&&!!n,cacheTime:0}),{updateCondition:f}=F(),[o,m]=p.useState(!1);p.useEffect(()=>{if(d)switch(r){case S.PRODUCTS:a(c=>({...c,products:{...c.products,id:d.id,operator:d.operator,items:d.products.map(y=>({id:y.id,label:y.title}))}}));break;case S.PRODUCT_COLLECTIONS:a(c=>({...c,product_collections:{...c.product_collections,id:d.id,operator:d.operator,items:d.product_collections.map(y=>({id:y.id,label:y.title}))}}));break;case S.PRODUCT_TAGS:a(c=>({...c,product_tags:{...c.product_tags,id:d.id,operator:d.operator,items:d.product_tags.map(y=>({id:y.id,label:y.value}))}}));break;case S.CUSTOMER_GROUPS:a(c=>({...c,customer_groups:{...c.customer_groups,id:d.id,operator:d.operator,items:d.customer_groups.map(y=>({id:y.id,label:y.name}))}}));break;case S.PRODUCT_TYPES:a(c=>({...c,product_types:{...c.product_types,id:d.id,operator:d.operator,items:d.product_types.map(y=>({id:y.id,label:y.value}))}}));break}},[d,r]);const[g,u]=p.useMemo(()=>{const c=Math.max(Math.floor(3.6363636363636362)-1,1),y=i.slice(0,c),C=i.length-c;return[y,C]},[i]);return i.length?l("div",{children:[l("div",{className:"p-base border rounded-rounded flex gap-base justify-between items-center",children:[l("div",{className:"flex overflow-hidden gap-base w-full",children:[e("div",{children:l(Xe,{className:"inter-base-semibold flex justify-center items-center w-[40px] h-[40px]",variant:"default",children:["ยง",t+1]})}),l("div",{className:"truncate flex flex-col justify-center flex-1 w-full",children:[e("div",{className:"inter-small-semibold",children:zr(r)}),e("div",{className:"w-full flex items-center inter-small-regular gap-x-xsmall flex-1",children:l("div",{className:"gap-x-2xsmall text-grey-50 flex items-center w-full inter-small-regular flex-1",children:[g.map((c,y)=>l("span",{children:[r===S.PRODUCT_TAGS&&"#",c.label,y!==g.length-1&&", "]},y)),u>0&&l("span",{className:"text-grey-40 ml-2",children:["+",u," more"]})]})})]})]}),e("div",{children:e(_t,{forceDropdown:!0,actions:[{label:"Edit",onClick:()=>m(!0),icon:e(xe,{size:16})},{label:"Delete condition",onClick:()=>f({type:r,items:[],operator:j.IN}),icon:e(ne,{size:16}),variant:"danger"}]})})]}),o&&e(Lr,{onClose:()=>m(!1),view:r})]}):null},zr=t=>{switch(t){case S.PRODUCTS:return"Product";case S.PRODUCT_COLLECTIONS:return"Collection";case S.PRODUCT_TAGS:return"Tag";case S.CUSTOMER_GROUPS:return"Customer group";case S.PRODUCT_TYPES:return"Type"}},Gr=({discount:t})=>{var d;const{setConditions:s,conditions:n}=F(),[r,a]=p.useState(!1);p.useEffect(()=>{var f;if((f=t==null?void 0:t.rule)!=null&&f.conditions)for(const o of t.rule.conditions)s(m=>({...m,[o.type]:{...n[o.type],id:o.id,operator:o.operator,type:o.type}}))},[(d=t==null?void 0:t.rule)==null?void 0:d.conditions]);const i=p.useMemo(()=>Object.values(n).every(o=>o.items.length),[n]),h=p.useMemo(()=>Object.values(n).filter(f=>f.id||f.items.length),[n]);return l("div",{className:"pt-5",children:[e("div",{className:"flex flex-col gap-y-small",children:h.map((f,o)=>e(Ur,{index:o,discountId:t==null?void 0:t.id,conditionId:f.id,type:f.type,setCondition:s,items:f.items},o))}),!i&&l(_,{size:"small",variant:"ghost",onClick:()=>a(!0),className:"mt-4 p-2 w-full rounded-rounded border",children:[e(Se,{size:18}),e("span",{children:"Add Condition"})]}),r&&e(It,{onClose:()=>a(!1),conditions:n})]})},qr=t=>{const s=[];return t.usage_limit!==null&&s.push("usage_limit"),t.starts_at!==null&&s.push("starts_at"),t.ends_at!==null&&s.push("ends_at"),t.valid_duration!==null&&s.push("valid_duration"),s},$r=({promotion:t,isEdit:s=!1})=>{const{register:n,control:r,isDynamic:a,hasExpiryDate:i,handleConfigurationChanged:h}=F(),[d,f]=Qe.useState(s&&t?qr(t):[...i?["ends_at"]:[]]),o="transition-[margin] duration-300 ease-[cubic-bezier(0.87, 0, 0.13, 1) forwards]",[m,g]=p.useState(!1);return p.useEffect(()=>{setTimeout(()=>g(!0),300)},[]),e("div",{className:"flex flex-col",children:e(Z,{className:"pt-7 text-grey-90",type:"multiple",value:d||[],onValueChange:u=>{h(u),f(u)},children:m&&l(D,{children:[e(Z.Item,{headingSize:"medium",forceMountContent:!0,className:"border-b-0",title:"Start date",subtitle:"Schedule the discount to activate in the future.",tooltip:"If you want to schedule the discount to activate in the future, you can set a start date here, otherwise the discount will be active immediately.",value:"starts_at",customTrigger:e(he,{checked:d.indexOf("starts_at")>-1}),children:e("div",{className:ee("flex items-center gap-xsmall",o,{"mt-4":d.indexOf("starts_at")>-1}),children:e(G,{name:"starts_at",control:r,render:({field:{value:u,onChange:c}})=>{const y=u||new Date;return l(D,{children:[e(Be,{date:y,label:"Start date",onSubmitDate:c}),e(Ve,{label:"Start time",date:y,onSubmitDate:c})]})}})})}),e(Z.Item,{headingSize:"medium",forceMountContent:!0,className:"border-b-0",title:"Discount has an expiry date?",subtitle:"Schedule the discount to deactivate in the future.",tooltip:"If you want to schedule the discount to deactivate in the future, you can set an expiry date here.",value:"ends_at",customTrigger:e(he,{checked:d.indexOf("ends_at")>-1}),children:e("div",{className:ee("flex items-center gap-xsmall",o,{"mt-4":d.indexOf("ends_at")>-1}),children:e(G,{name:"ends_at",control:r,render:({field:{value:u,onChange:c}})=>{const y=u||new Date(new Date().getTime()+6048e5);return l(D,{children:[e(Be,{date:y,label:"Expiry date",onSubmitDate:c}),e(Ve,{label:"Expiry time",date:y,onSubmitDate:c})]})}})})}),e(Z.Item,{headingSize:"medium",forceMountContent:!0,className:"border-b-0",title:"Limit the number of redemptions?",subtitle:"Limit applies across all customers, not per customer.",tooltip:"If you wish to limit the amount of times a customer can redeem this discount, you can set a limit here.",value:"usage_limit",customTrigger:e(he,{checked:d.indexOf("usage_limit")>-1}),children:e("div",{className:ee(o,{"mt-4":d.indexOf("usage_limit")>-1}),children:e(V,{...n("usage_limit",{valueAsNumber:!0}),label:"Number of redemptions",type:"number",placeholder:"5",min:1})})}),a&&e(Z.Item,{disabled:!a,headingSize:"medium",forceMountContent:!0,title:"Availability duration?",className:"border-b-0",subtitle:"Set the duration of the discount.",tooltip:"Select a discount type",value:"valid_duration",customTrigger:e(he,{checked:d.indexOf("valid_duration")>-1}),children:e("div",{className:ee(o,{"mt-4":d.indexOf("valid_duration")>-1}),children:e(G,{name:"valid_duration",control:r,render:({field:{value:u,onChange:c}})=>e(Ft,{value:u??void 0,onChange:c})})})})]})})})},Br=()=>{const{control:t}=F();return e(G,{name:"rule.allocation",control:t,rules:{required:!0},render:({field:{onChange:s,value:n}})=>l(K.Root,{value:n,onValueChange:s,className:ee("flex items-center gap-base mt-base px-1"),children:[e(K.Item,{value:le.TOTAL,className:"flex-1",label:"Total amount",description:"Apply to the total amount"}),e(K.Item,{value:le.ITEM,className:"flex-1",label:"Item specific",description:"Apply to every allowed item"})]})})},Vr=()=>{const{control:t}=F(),s=We({control:t,name:"regions"});return e(G,{name:"rule.type",control:t,rules:{required:!0},render:({field:{onChange:n,value:r}})=>l(K.Root,{value:r,onValueChange:n,className:ee("flex items-center gap-base mt-base px-1"),children:[e(K.Item,{value:se.PERCENTAGE,className:"flex-1",label:"Percentage",description:"Discount applied in %"}),e(K.Item,{value:se.FIXED,className:"flex-1",label:"Fixed amount",description:"Discount in whole numbers",disabled:Array.isArray(s)&&s.length>1,disabledTooltip:"You can only select one valid region if you want to use the fixed amount type"}),e(K.Item,{value:se.FREE_SHIPPING,className:"flex-1",label:"Free shipping",description:"Override delivery amount"})]})})},Yr=({discount:t})=>{var g;const s=((g=t==null?void 0:t.regions)==null?void 0:g[0].currency_code)||void 0,[n,r]=p.useState(s),{regions:a,isLoading:i}=St(),{register:h,control:d,type:f}=F(),o=We({control:d,name:"regions"});p.useEffect(()=>{if(f==="fixed"&&o){let u;Array.isArray(o)&&o.length?u=o[0].value:u=o.value;const c=a==null?void 0:a.find(y=>y.id===u);c&&r(c.currency_code)}},[f,a,o]);const m=p.useMemo(()=>(a==null?void 0:a.map(u=>({value:u.id,label:u.name})))||[],[a]);return e("div",{className:"pt-5",children:!i&&l(D,{children:[e(G,{name:"regions",control:d,rules:{required:"At least one region is required",validate:u=>Array.isArray(u)?u.length>0:!!u},render:({field:{onChange:u,value:c}})=>e(Tt,{value:c||null,onChange:y=>{u(f==="fixed"?[y]:y)},label:"Choose valid regions",isMulti:f!=="fixed",selectAll:f!=="fixed",isSearchable:!0,required:!0,options:m})}),l("div",{className:"flex gap-x-base gap-y-base my-base",children:[e(V,{label:"Code",className:"flex-1",placeholder:"SUMMERSALE10",required:!0,...h("code",{required:"Code is required"})}),f!=="free_shipping"&&e(D,{children:f==="fixed"?e("div",{className:"flex-1",children:e(Ye.Root,{size:"small",currentCurrency:n,readOnly:!0,hideCurrency:!0,children:e(G,{name:"rule.value",control:d,rules:{required:"Amount is required",min:1},render:({field:{value:u,onChange:c}})=>e(Ye.Amount,{label:"Amount",required:!0,amount:u,onChange:c})})})}):e("div",{className:"flex-1",children:e(V,{label:"Percentage",min:0,required:!0,type:"number",placeholder:"10",prefix:"%",...h("rule.value",{required:!0,valueAsNumber:!0})})})})]}),l("div",{className:"text-grey-50 inter-small-regular flex flex-col mb-6",children:[e("span",{children:"The code your customers will enter during checkout. This will appear on your customerโs invoice."}),e("span",{children:"Uppercase letters and numbers only."})]}),e(Pt,{label:"Description",required:!0,placeholder:"Summer Sale 2022",rows:1,...h("rule.description",{required:!0})}),l("div",{className:"mt-xlarge flex items-center",children:[e(G,{name:"is_dynamic",control:d,render:({field:{onChange:u,value:c}})=>e(ys,{label:"This is a template discount",name:"is_dynamic",id:"is_dynamic",checked:c,onChange:y=>u(y.target.checked)})}),e(at,{content:"Template discounts allow you to define a set of rules that can be used across a group of discounts. This is useful in campaigns that should generate unique codes for each user, but where the rules for all unique codes should be the same."})]})]})})},Mt=({closeForm:t})=>{const s=fe(),n=Y(),{handleSubmit:r,handleReset:a,control:i}=F(),{onSaveAsActive:h,onSaveAsInactive:d}=Ir(),f=()=>{t?t():s("/a/discounts"),a()},o=async u=>{d(u).then(()=>{f(),a()}).catch(c=>{n("Error",q(c),"error")})},m=async u=>{try{await h(u),f(),a()}catch(c){n("Error",q(c),"error")}},g=We({control:i,name:"rule.type"});return l(Ke,{children:[e(Ke.Header,{children:l("div",{className:"medium:w-8/12 w-full px-8 flex justify-between",children:[e(_,{size:"small",variant:"ghost",onClick:t,className:"border rounded-rounded w-8 h-8",children:e(Qt,{size:20})}),l("div",{className:"gap-x-small flex",children:[e(_,{onClick:r(o),size:"small",variant:"ghost",className:"border rounded-rounded",children:"Save as draft"}),e(_,{size:"small",variant:"primary",onClick:r(m),className:"rounded-rounded",children:"Publish discount"})]})]})}),e(Ke.Main,{children:e("div",{className:"flex justify-center mb-[25%]",children:l("div",{className:"max-w-[700px] w-full pt-16",children:[e("h1",{className:"inter-xlarge-semibold",children:"Create new discount"}),l(Z,{className:"pt-7 text-grey-90",defaultValue:["promotion-type"],type:"multiple",children:[l(Z.Item,{forceMountContent:!0,title:"Discount type",required:!0,tooltip:"Select a discount type",value:"promotion-type",children:[e(Vr,{}),g===se.FIXED&&l("div",{className:"mt-xlarge",children:[l("h3",{className:"inter-base-semibold",children:["Allocation",e("span",{className:"text-rose-50",children:"*"})]}),e(Br,{})]})]}),e(Z.Item,{title:"General",required:!0,value:"general",forceMountContent:!0,children:e(Yr,{})}),e(Z.Item,{forceMountContent:!0,title:"Configuration",value:"configuration",description:"Discount code applies from you hit the publish button and forever if left untouched.",children:e($r,{})}),e(Z.Item,{forceMountContent:!0,title:"Conditions",description:"Discount code apply to all products if left untouched.",value:"conditions",tooltip:"Add conditions to your Discount",children:e(Gr,{})})]})]})})})]})},Qr=()=>e("div",{className:"pb-xlarge",children:e(ct,{children:e(Mt,{})})}),Jr=()=>{const[t,s]=p.useState(!1);return l("div",{className:"h-full flex flex-col",children:[e("div",{className:"w-full flex flex-col grow",children:e(Je,{actionables:[{label:"Add Discount",onClick:()=>s(!0),icon:e(Se,{size:20})}],customHeader:e(Wt,{views:["discounts"]}),className:"h-fit",children:e($s,{})})}),e(ct,{children:e(Xt,{isVisible:t,isFullScreen:!0,children:e(Mt,{closeForm:()=>s(!1)})})})]})},aa=()=>l(Jt,{children:[e(Ze,{index:!0,element:e(Jr,{})}),e(Ze,{path:"/new",element:e(Qr,{})}),e(Ze,{path:"/:id",element:e(Rr,{})})]});export{aa as default};
